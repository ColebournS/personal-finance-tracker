{"version":3,"file":"static/js/334.78d29b16.chunk.js","mappings":"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","sources":["components/BulkPurchaseImport.js","components/SettingsMobile.js"],"sourcesContent":["import React, { useState, useRef } from \"react\";\nimport { Upload, X, Save, AlertCircle } from \"lucide-react\";\nimport supabase from \"../supabaseClient.js\";\nimport { useData } from \"../DataContext\";\n\nconst BulkPurchaseImport = () => {\n  const { userId, refetchPurchases } = useData();\n  const dialogRef = useRef(null);\n  const [rawData, setRawData] = useState(\"\");\n  const [mappings, setMappings] = useState({\n    itemName: \"\",\n    cost: \"\",\n    date: \"\",\n  });\n  const [preview, setPreview] = useState([]);\n  const [headers, setHeaders] = useState([]);\n  const [error, setError] = useState(\"\");\n\n  const detectDelimiter = (text) => {\n    const firstLine = text.split(\"\\n\")[0];\n    if (!firstLine) return null;\n\n    const delimiters = [\"\\t\", \",\", \";\"];\n    const counts = delimiters.map((d) => ({\n      delimiter: d,\n      count: (firstLine.match(new RegExp(d, \"g\")) || []).length,\n    }));\n\n    const mostLikely = counts.reduce(\n      (max, curr) => (curr.count > max.count ? curr : max),\n      { delimiter: null, count: 0 }\n    );\n\n    return mostLikely.count > 0 ? mostLikely.delimiter : null;\n  };\n\n  const parseData = (raw) => {\n    try {\n      if (!raw.trim()) {\n        setError(\"No data provided\");\n        return;\n      }\n\n      const delimiter = detectDelimiter(raw);\n      if (!delimiter) {\n        setError(\n          \"Could not detect a valid delimiter (tab, comma, or semicolon)\"\n        );\n        return;\n      }\n\n      const lines = raw\n        .trim()\n        .split(\"\\n\")\n        .map((line) => line.trim());\n      if (lines.length < 2) {\n        setError(\"At least two lines are required (headers and data)\");\n        return;\n      }\n\n      const headers = lines[0].split(delimiter).map((h) => h.trim());\n      if (headers.length < 2) {\n        setError(\n          `Only found ${headers.length} column(s). Please check the format.`\n        );\n        return;\n      }\n\n      const data = lines.slice(1).map((line) => {\n        const values = line.split(delimiter).map((v) => v.trim());\n        return headers.reduce((obj, header, index) => {\n          obj[header] = values[index] || \"\";\n          return obj;\n        }, {});\n      });\n\n      setHeaders(headers);\n      setPreview(data);\n      setError(\"\");\n    } catch (err) {\n      console.error(\"Parsing error:\", err);\n      setError(`Parsing error: ${err.message}`);\n      setPreview([]);\n    }\n  };\n\n  const handlePaste = (e) => {\n    const text = e.target.value;\n    setRawData(text);\n    parseData(text);\n  };\n\n  const handleMapping = (field, header) => {\n    setMappings((prev) => ({\n      ...prev,\n      [field]: header,\n    }));\n  };\n\n  const validateMapping = () => {\n    if (!mappings.itemName) return \"Item Name mapping is required\";\n    if (!mappings.cost) return \"Cost mapping is required\";\n    return null;\n  };\n\n  const formatDate = (dateStr) => {\n    if (!dateStr) return new Date().toISOString();\n\n    // Try parsing the date string\n    const parsedDate = new Date(dateStr);\n\n    // Check if the date is valid\n    if (isNaN(parsedDate.getTime())) {\n      return new Date().toISOString();\n    }\n\n    return parsedDate.toISOString();\n  };\n\n  const handleImport = async () => {\n    const validationError = validateMapping();\n    if (validationError) {\n      setError(validationError);\n      return;\n    }\n\n    try {\n      const purchases = preview\n        .map((row) => ({\n          item_name: row[mappings.itemName]?.trim() || \"\",\n          cost: parseFloat(row[mappings.cost]) || 0,\n          user_id: userId,\n          budget_item_id: null,\n          timestamp: formatDate(mappings.date ? row[mappings.date] : null),\n        }))\n        .filter((p) => p.item_name && !isNaN(p.cost));\n\n      const { error } = await supabase.from(\"purchases\").insert(purchases);\n\n      if (error) throw error;\n\n      alert(\"Purchases imported successfully!\");\n      dialogRef.current?.close();\n      setRawData(\"\");\n      setPreview([]);\n      setMappings({\n        itemName: \"\",\n        cost: \"\",\n        date: \"\",\n      });\n    } catch (error) {\n      console.error(\"Error importing purchases:\", error);\n      setError(\"Failed to import purchases. Please try again.\");\n    }\n  };\n\n  return (\n    <>\n      <button\n        onClick={() => dialogRef.current?.showModal()}\n        className=\"w-full bg-green-500 dark:bg-green-600 text-white py-2 rounded-md hover:bg-green-600 dark:hover:bg-green-700 transition-colors flex items-center justify-center mt-4\"\n      >\n        <Upload className=\"mr-2\" size={20} />\n        Bulk Import\n      </button>\n\n      <dialog\n        ref={dialogRef}\n        className=\"w-full max-w-3xl rounded-lg p-6 backdrop:bg-black backdrop:bg-opacity-50 bg-white dark:bg-slate-800\"\n      >\n        <div className=\"space-y-4\">\n          <div className=\"flex justify-between items-center\">\n            <h2 className=\"text-xl font-bold text-gray-800 dark:text-white\">Bulk Import Purchases</h2>\n            <button\n              onClick={() => dialogRef.current?.close()}\n              className=\"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300\"\n            >\n              <X size={20} />\n            </button>\n          </div>\n\n          {error && (\n            <div className=\"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 dark:border-red-600 p-4 text-red-700 dark:text-red-300\">\n              <div className=\"flex\">\n                <AlertCircle className=\"h-5 w-5 mr-2\" />\n                <span>{error}</span>\n              </div>\n            </div>\n          )}\n\n          <div>\n            <label className=\"block text-sm font-medium mb-2 text-gray-700 dark:text-gray-200\">\n              Paste your data (tab, comma, or semicolon separated):\n            </label>\n            <div className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">\n              Example format:\n              <br />\n              Item Name,Cost,Date\n              <br />\n              Groceries,45.99,2024-02-14\n            </div>\n            <textarea\n              value={rawData}\n              onChange={handlePaste}\n              className=\"w-full h-32 p-2 border dark:border-gray-600 rounded-md font-mono text-sm bg-white dark:bg-slate-700 text-gray-800 dark:text-white\"\n              placeholder=\"Item Name,Cost,Date\"\n            />\n          </div>\n\n          {headers.length > 0 && (\n            <div className=\"space-y-4\">\n              <h3 className=\"font-medium text-gray-800 dark:text-white\">Map Columns</h3>\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm mb-1 text-gray-700 dark:text-gray-200\">Item Name*</label>\n                  <select\n                    value={mappings.itemName}\n                    onChange={(e) => handleMapping(\"itemName\", e.target.value)}\n                    className=\"w-full p-2 border dark:border-gray-600 rounded-md bg-white dark:bg-slate-700 text-gray-800 dark:text-white\"\n                  >\n                    <option value=\"\">Select column</option>\n                    {headers.map((h) => (\n                      <option key={h} value={h}>\n                        {h}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-sm mb-1 text-gray-700 dark:text-gray-200\">Cost*</label>\n                  <select\n                    value={mappings.cost}\n                    onChange={(e) => handleMapping(\"cost\", e.target.value)}\n                    className=\"w-full p-2 border dark:border-gray-600 rounded-md bg-white dark:bg-slate-700 text-gray-800 dark:text-white\"\n                  >\n                    <option value=\"\">Select column</option>\n                    {headers.map((h) => (\n                      <option key={h} value={h}>\n                        {h}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-sm mb-1 text-gray-700 dark:text-gray-200\">Date (Optional)</label>\n                  <select\n                    value={mappings.date}\n                    onChange={(e) => handleMapping(\"date\", e.target.value)}\n                    className=\"w-full p-2 border dark:border-gray-600 rounded-md bg-white dark:bg-slate-700 text-gray-800 dark:text-white\"\n                  >\n                    <option value=\"\">Select column</option>\n                    {headers.map((h) => (\n                      <option key={h} value={h}>\n                        {h}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n              </div>\n\n              {preview.length > 0 && (\n                <div>\n                  <h3 className=\"font-medium mb-2 text-gray-800 dark:text-white\">\n                    Preview ({preview.length} rows)\n                  </h3>\n                  <div className=\"max-h-48 overflow-auto border dark:border-gray-600 rounded-md\">\n                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-600\">\n                      <thead className=\"bg-gray-50 dark:bg-slate-700\">\n                        <tr>\n                          {headers.map((header) => (\n                            <th\n                              key={header}\n                              className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\"\n                            >\n                              {header}\n                            </th>\n                          ))}\n                        </tr>\n                      </thead>\n                      <tbody className=\"bg-white dark:bg-slate-600 divide-y divide-gray-200 dark:divide-gray-600\">\n                        {preview.slice(0, 5).map((row, idx) => (\n                          <tr key={idx}>\n                            {headers.map((header) => (\n                              <td key={header} className=\"px-4 py-2 text-sm text-gray-800 dark:text-white\">\n                                {row[header]}\n                              </td>\n                            ))}\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          <div className=\"flex justify-end space-x-2 mt-4 pt-4 border-t dark:border-gray-600\">\n            <button\n              onClick={() => dialogRef.current?.close()}\n              className=\"px-4 py-2 border dark:border-gray-600 rounded-md hover:bg-gray-100 dark:hover:bg-slate-700 text-gray-800 dark:text-white\"\n            >\n              <X className=\"mr-2 inline-block\" size={16} />\n              Cancel\n            </button>\n            <button\n              onClick={handleImport}\n              disabled={!preview.length || !mappings.itemName || !mappings.cost}\n              className=\"px-4 py-2 bg-blue-500 dark:bg-blue-600 text-white rounded-md hover:bg-blue-600 dark:hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              <Save className=\"mr-2 inline-block\" size={16} />\n              Import\n            </button>\n          </div>\n        </div>\n      </dialog>\n    </>\n  );\n};\n\nexport default BulkPurchaseImport;\n","import React, { useState, useEffect, useRef } from \"react\";\nimport { Download, LogOut } from \"lucide-react\";\nimport * as XLSX from \"xlsx\";\nimport supabase from \"../supabaseClient\";\nimport BulkPurchaseImport from \"./BulkPurchaseImport\";\n\nconst SettingsMobile = ({\n  onToggleIncome = () => {},\n  onToggleRecommended = () => {},\n}) => {\n  const [hideIncome, setHideIncome] = useState(false);\n  const [hideRecommended, setHideRecommended] = useState(false);\n  const popupRef = useRef(null);\n  const [userId, setUserId] = useState(null);\n\n  useEffect(() => {\n    const getCurrentUser = async () => {\n      const {\n        data: { user },\n      } = await supabase.auth.getUser();\n      if (user) {\n        setUserId(user.id);\n      }\n    };\n    getCurrentUser();\n  }, []);\n\n  useEffect(() => {\n    if (userId) {\n      fetchProfileData();\n\n      const profileChannel = supabase\n        .channel(`profile_changes_${userId}`)\n        .on(\n          \"postgres_changes\",\n          {\n            event: \"*\",\n            schema: \"public\",\n            table: \"profiles\",\n            match: { id: userId },\n          },\n          () => fetchProfileData()\n        )\n        .subscribe();\n\n      return () => {\n        profileChannel.unsubscribe();\n      };\n    }\n  }, [userId]);\n\n  const fetchProfileData = async () => {\n    try {\n      const { data, error } = await supabase\n        .from(\"profiles\")\n        .select(\"hide_income, hide_recommended_budget\")\n        .eq(\"id\", userId)\n        .single();\n\n      if (error) {\n        console.error(\"Error fetching profile data:\", error);\n        return;\n      }\n\n      if (data) {\n        setHideIncome(data.hide_income || false);\n        setHideRecommended(data.hide_recommended_budget || false);\n        onToggleIncome(!data.hide_income);\n        onToggleRecommended(!data.hide_recommended_budget);\n      }\n    } catch (err) {\n      console.error(\"Unexpected error:\", err);\n    }\n  };\n\n  const updateProfile = async (updates) => {\n    try {\n      const { error } = await supabase\n        .from(\"profiles\")\n        .update(updates)\n        .eq(\"id\", userId);\n\n      if (error) {\n        console.error(\"Error updating profile:\", error);\n      }\n    } catch (err) {\n      console.error(\"Unexpected error:\", err);\n    }\n  };\n\n  const handleIncomeToggle = async () => {\n    const newValue = !hideIncome;\n    setHideIncome(newValue);\n    onToggleIncome(!newValue);\n    await updateProfile({ hide_income: newValue });\n  };\n\n  const handleRecommendedToggle = async () => {\n    const newValue = !hideRecommended;\n    setHideRecommended(newValue);\n    onToggleRecommended(!newValue);\n    await updateProfile({ hide_recommended_budget: newValue });\n  };\n\n  const handleSignOut = async () => {\n    try {\n      const { error } = await supabase.auth.signOut();\n      if (error) throw error;\n      // The page will likely need to refresh or redirect after sign out\n      window.location.href = \"/\";\n    } catch (error) {\n      console.error(\"Error signing out:\", error);\n    }\n  };\n\n  const exportToExcel = async () => {\n    try {\n      const { data: budgetGroups, error: groupsError } = await supabase\n        .from(\"budget_groups\")\n        .select(\"*\")\n        .eq(\"id\", userId);\n\n      if (groupsError) throw groupsError;\n\n      const { data: budgetItems, error: itemsError } = await supabase\n        .from(\"budget_items\")\n        .select(\"*\")\n        .eq(\"id\", userId);\n\n      if (itemsError) throw itemsError;\n\n      const { data: purchases, error: purchasesError } = await supabase\n        .from(\"purchases\")\n        .select(\"*\")\n        .eq(\"id\", userId);\n\n      if (purchasesError) throw purchasesError;\n\n      const budgetItemsData = budgetItems.map((item) => {\n        const group = budgetGroups.find((g) => g.id === item.group_id);\n        return {\n          Group: group?.name || \"Unknown\",\n          ItemName: item.name,\n          Budget: item.budget,\n          ItemID: item.id,\n        };\n      });\n\n      const purchasesData = purchases.map((purchase) => ({\n        ItemName: purchase.item_name,\n        Cost: purchase.cost,\n        BudgetGroup: purchase.budget_item_id,\n        Timestamp: new Date(purchase.timestamp).toLocaleString(),\n      }));\n\n      const workbook = XLSX.utils.book_new();\n\n      const budgetItemsSheet = XLSX.utils.json_to_sheet(budgetItemsData);\n      XLSX.utils.book_append_sheet(workbook, budgetItemsSheet, \"Budget Items\");\n\n      const purchasesSheet = XLSX.utils.json_to_sheet(purchasesData);\n      XLSX.utils.book_append_sheet(workbook, purchasesSheet, \"Purchases\");\n\n      const groupsSheet = XLSX.utils.json_to_sheet(budgetGroups);\n      XLSX.utils.book_append_sheet(workbook, groupsSheet, \"Budget Groups\");\n\n      XLSX.writeFile(workbook, \"Budget_Export.xlsx\");\n    } catch (error) {\n      console.error(\"Error exporting data to Excel: \", error);\n      throw error;\n    }\n  };\n\n\n  return (\n    <div className=\"w-full mx-auto p-6 bg-white dark:bg-slate-800 shadow-lg rounded-lg\">\n      <h1 className=\"text-3xl font-bold text-center text-gray-800 dark:text-white mb-6\">\n        Settings\n      </h1>\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between p-2 hover:bg-gray-50 dark:hover:bg-slate-700 rounded-md\">\n          <div>\n            <h3 className=\"text-sm font-medium text-gray-900 dark:text-white\">Hide Income</h3>\n            <p className=\"text-sm text-gray-500 dark:text-gray-400\">Toggle income visibility</p>\n          </div>\n          <label className=\"relative inline-flex items-center cursor-pointer\">\n            <input\n              type=\"checkbox\"\n              checked={hideIncome}\n              onChange={handleIncomeToggle}\n              className=\"sr-only peer\"\n            />\n            <div className=\"w-11 h-6 bg-gray-200 dark:bg-gray-600 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600\"></div>\n          </label>\n        </div>\n\n        <div className=\"flex items-center justify-between p-2 hover:bg-gray-50 dark:hover:bg-slate-700 rounded-md\">\n          <div>\n            <h3 className=\"text-sm font-medium text-gray-900 dark:text-white\">\n              Hide Recommended Budget\n            </h3>\n            <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n              Toggle recommended budget visibility\n            </p>\n          </div>\n          <label className=\"relative inline-flex items-center cursor-pointer\">\n            <input\n              type=\"checkbox\"\n              checked={hideRecommended}\n              onChange={handleRecommendedToggle}\n              className=\"sr-only peer\"\n            />\n            <div className=\"w-11 h-6 bg-gray-200 dark:bg-gray-600 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600\"></div>\n          </label>\n        </div>\n\n        <button\n          onClick={exportToExcel}\n          className=\"w-full flex items-center justify-center gap-2 p-2 text-sm font-medium text-white bg-blue-600 dark:bg-blue-700 hover:bg-blue-700 dark:hover:bg-blue-800 rounded-md transition-colors\"\n        >\n          <Download className=\"w-4 h-4\" />\n          Export Data\n        </button>\n\n        <BulkPurchaseImport />\n\n        <div className=\"border-t border-gray-200 dark:border-gray-600 pt-4\">\n          <button\n            onClick={handleSignOut}\n            className=\"w-full flex items-center justify-center gap-2 p-2 text-sm font-medium text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors\"\n          >\n            <LogOut className=\"w-4 h-4\" />\n            Sign Out\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SettingsMobile;\n"],"names":["BulkPurchaseImport","userId","refetchPurchases","useData","dialogRef","useRef","rawData","setRawData","useState","mappings","setMappings","itemName","cost","date","preview","setPreview","headers","setHeaders","error","setError","parseData","raw","trim","delimiter","text","firstLine","split","mostLikely","map","d","count","match","RegExp","length","reduce","max","curr","detectDelimiter","lines","line","h","concat","data","slice","values","v","obj","header","index","err","console","message","handleMapping","field","prev","_objectSpread","formatDate","dateStr","Date","toISOString","parsedDate","isNaN","getTime","_jsxs","_Fragment","children","onClick","_dialogRef$current2","current","showModal","className","_jsx","Upload","size","ref","_dialogRef$current3","close","X","AlertCircle","value","onChange","e","target","placeholder","row","idx","_dialogRef$current4","async","validationError","_dialogRef$current","purchases","_row$mappings$itemNam","item_name","parseFloat","user_id","budget_item_id","timestamp","filter","p","supabase","from","insert","alert","disabled","Save","_ref","onToggleIncome","onToggleRecommended","hideIncome","setHideIncome","hideRecommended","setHideRecommended","setUserId","useEffect","user","auth","getUser","id","getCurrentUser","fetchProfileData","profileChannel","channel","on","event","schema","table","subscribe","unsubscribe","select","eq","single","hide_income","hide_recommended_budget","updateProfile","update","updates","type","checked","newValue","budgetGroups","groupsError","budgetItems","itemsError","purchasesError","budgetItemsData","item","group","find","g","group_id","Group","name","ItemName","Budget","budget","ItemID","purchasesData","purchase","Cost","BudgetGroup","Timestamp","toLocaleString","workbook","XLSX","book_new","budgetItemsSheet","json_to_sheet","book_append_sheet","purchasesSheet","groupsSheet","Download","signOut","window","location","href","LogOut"],"sourceRoot":""}