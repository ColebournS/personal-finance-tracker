/*! For license information please see 649.d1e1e3e4.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkpersonal_finance_tracker=self.webpackChunkpersonal_finance_tracker||[]).push([[649],{1649:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var a=r(9379),d=r(5043),s=r(6058),l=r(9042),o=r(6361),i=r(3709),n=r(2031),m=r(885),c=r(4183),b=r(7669),g=r(3500),x=r(1114);const u=(0,x.A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),h=(0,x.A)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var p=r(579);o.t1.register(o.PP,o.kc,o.E8,o.hE,o.m_,o.s$,l.A);const f=function(){var e,t,r,o,x,f;const{userId:k}=(0,n.E)(),[y,v]=(0,d.useState)(!1),[w,j]=(0,d.useState)(!1),[N,D]=(0,d.useState)({labels:[],datasets:[]}),[C,S]=(0,d.useState)([]),[A,F]=(0,d.useState)(new Set),[M,_]=(0,d.useState)(!1),[z,I]=(0,d.useState)({fromDate:new Date((new Date).getFullYear(),(new Date).getMonth(),1).toISOString().split("T")[0],toDate:new Date((new Date).getFullYear(),(new Date).getMonth()+1,0).toISOString().split("T")[0]}),O=(0,d.useCallback)((async()=>{if(!k)return;_(!0);const{data:e,error:t}=await i.A.from("budget_items").select("\n        id, \n        name,\n        budget,\n        hidden,\n        is_active,\n        purchases!inner (cost, timestamp, is_deleted)\n        ").eq("user_id",k).eq("purchases.is_deleted",!1).gte("purchases.timestamp",z.fromDate).lte("purchases.timestamp",z.toDate);if(t)return console.error("Budget fetch error:",t),void _(!1);const r=(e||[]).filter((e=>!1!==e.is_active)).map((e=>(0,a.A)((0,a.A)({},e),{},{budget:(0,m.pN)(e.budget,k)})));S(r);const d=new Set(r.filter((e=>e.hidden)).map((e=>e.id)));F(d);const s=r.filter((e=>!e.hidden)),l=s.map((e=>e.budget)),o=s.map((e=>e.purchases.reduce(((e,t)=>e+t.cost),0))),n={labels:s.map((e=>e.name)),datasets:[{label:"Budgeted",data:l,backgroundColor:"rgba(59, 130, 246, 0.6)",borderColor:"rgb(37, 99, 235)",borderWidth:1,borderRadius:6,hoverBackgroundColor:"rgba(59, 130, 246, 0.8)"},{label:"Spent",data:o,backgroundColor:"rgba(239, 68, 68, 0.6)",borderColor:"rgb(220, 38, 38)",borderWidth:1,borderRadius:6,hoverBackgroundColor:"rgba(239, 68, 68, 0.8)"}]};return D(n),_(!1),n}),[k,z]);(0,d.useEffect)((()=>{if(k){O();const e=i.A.channel("budget_items_".concat(k)).on("postgres_changes",{event:"*",schema:"public",table:"budget_items",match:{user_id:k}},O).subscribe(),t=i.A.channel("purchases_".concat(k)).on("postgres_changes",{event:"*",schema:"public",table:"purchases",match:{user_id:k}},O).subscribe();return()=>{i.A.removeChannel(e),i.A.removeChannel(t)}}}),[k,z,O]);const P=async e=>{const{name:t,value:r}=e.target;I((e=>(0,a.A)((0,a.A)({},e),{},{[t]:r})))},T={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",align:"center",labels:{usePointStyle:!0,pointStyle:"circle",boxWidth:8,boxHeight:8,padding:10,font:{family:"'Inter', sans-serif",size:13,weight:"600"},color:"#4b5563"}},tooltip:{backgroundColor:"rgba(30, 41, 59, 0.95)",titleColor:"#f3f4f6",bodyColor:"#e5e7eb",borderColor:"rgba(148, 163, 184, 0.2)",borderWidth:1,cornerRadius:8,titleFont:{family:"'Inter', sans-serif",size:14,weight:"600"},bodyFont:{family:"'Inter', sans-serif",size:13},padding:12,displayColors:!0,boxWidth:8,boxHeight:8,usePointStyle:!0,callbacks:{title:function(e){return e[0].label},label:function(e){let t=e.dataset.label||"";return t&&(t+=": $"),null!==e.parsed.y&&(t+=new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e.parsed.y)),t}}},datalabels:{anchor:"end",align:"bottom",formatter:e=>e<10?"":"".concat(Math.round(e)),font:{family:"'Inter', sans-serif",weight:"600",size:window.innerWidth<768?8:12},color:e=>{const t=["rgb(0, 0, 0)","rgb(0, 0, 0)"];return t[e.datasetIndex%t.length]},offset:0,textShadow:"0 1px 2px rgba(0, 0, 0, 0.2)"}},scales:{x:{grid:{display:!0,color:"rgba(0, 0, 0, 0.03)",drawBorder:!1},ticks:{padding:10,font:{family:"'Inter', sans-serif",size:12,weight:"500"},color:"#6b7280"},border:{color:"rgba(0, 0, 0, 0.05)"}},y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.04)",drawBorder:!1},border:{display:!1},ticks:{padding:10,stepSize:Math.ceil(Math.max(...N.datasets.flatMap((e=>e.data)))/5),font:{family:"'Inter', sans-serif",size:12},color:"#6b7280",callback:function(e){return"$"+new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}}}},animation:{duration:1200,easing:"easeOutQuart"},elements:{bar:{borderRadius:4,borderWidth:0,borderSkipped:!1}},barPercentage:.9,categoryPercentage:.8},Y=(null===(e=N.datasets)||void 0===e||null===(t=e[0])||void 0===t||null===(r=t.data)||void 0===r?void 0:r.reduce(((e,t)=>e+t),0))||0,B=(null===(o=N.datasets)||void 0===o||null===(x=o[1])||void 0===x||null===(f=x.data)||void 0===f?void 0:f.reduce(((e,t)=>e+t),0))||0,E=Y?B/Y*100:0;return(0,p.jsxs)("div",{className:"w-full mx-auto space-y-3 md:space-y-4",children:[w&&(0,p.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50 backdrop-blur-sm",onClick:()=>j(!1),children:(0,p.jsxs)("div",{className:"w-full max-w-lg bg-white dark:bg-slate-800 rounded-xl p-4 md:p-6 shadow-2xl border border-gray-200 dark:border-gray-700",onClick:e=>e.stopPropagation(),children:[(0,p.jsxs)("div",{className:"flex items-center justify-between mb-4 md:mb-5",children:[(0,p.jsxs)("div",{className:"flex items-center gap-2 md:gap-3",children:[(0,p.jsx)("div",{className:"inline-flex items-center justify-center w-8 h-8 md:w-10 md:h-10 rounded-lg bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400 shadow-sm",children:(0,p.jsx)(c.A,{size:16,className:"md:w-5 md:h-5"})}),(0,p.jsx)("h2",{className:"text-base md:text-xl font-bold text-gray-800 dark:text-white",children:"Date Range"})]}),(0,p.jsx)("button",{onClick:()=>j(!1),className:"p-2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-all",children:(0,p.jsx)(b.A,{size:20})})]}),(0,p.jsxs)("div",{className:"space-y-3 md:space-y-4",children:[(0,p.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 md:gap-4",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"fromDate",className:"block text-xs md:text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"From Date"}),(0,p.jsx)("input",{type:"date",id:"fromDate",name:"fromDate",value:z.fromDate,onChange:P,className:"w-full rounded-lg border-2 border-gray-300 dark:border-gray-600 px-3 py-2 md:px-4 md:py-2.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors bg-white dark:bg-slate-700 text-gray-800 dark:text-white shadow-sm"})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{htmlFor:"toDate",className:"block text-xs md:text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"To Date"}),(0,p.jsx)("input",{type:"date",id:"toDate",name:"toDate",value:z.toDate,onChange:P,className:"w-full rounded-lg border-2 border-gray-300 dark:border-gray-600 px-3 py-2 md:px-4 md:py-2.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors bg-white dark:bg-slate-700 text-gray-800 dark:text-white shadow-sm"})]})]}),(0,p.jsxs)("div",{className:"grid grid-cols-3 gap-2 md:gap-3",children:[(0,p.jsx)("button",{onClick:()=>{(()=>{const e=new Date;I({fromDate:new Date(e.getFullYear(),e.getMonth(),1).toISOString().split("T")[0],toDate:new Date(e.getFullYear(),e.getMonth()+1,0).toISOString().split("T")[0]})})(),j(!1)},className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 text-blue-700 dark:text-blue-300 px-3 py-2.5 md:px-4 md:py-3 rounded-lg hover:from-blue-500 hover:to-blue-600 hover:text-white dark:hover:from-blue-600 dark:hover:to-blue-700 transition-all font-semibold shadow-sm hover:shadow-md border border-blue-200 dark:border-blue-700 text-xs md:text-base",children:"Current Month"}),(0,p.jsx)("button",{onClick:()=>{(()=>{const e=new Date;I({fromDate:new Date(e.getFullYear(),e.getMonth()-1,1).toISOString().split("T")[0],toDate:new Date(e.getFullYear(),e.getMonth(),0).toISOString().split("T")[0]})})(),j(!1)},className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 text-blue-700 dark:text-blue-300 px-3 py-2.5 md:px-4 md:py-3 rounded-lg hover:from-blue-500 hover:to-blue-600 hover:text-white dark:hover:from-blue-600 dark:hover:to-blue-700 transition-all font-semibold shadow-sm hover:shadow-md border border-blue-200 dark:border-blue-700 text-xs md:text-base",children:"Previous Month"}),(0,p.jsx)("button",{onClick:()=>{(()=>{const e=new Date;I({fromDate:new Date(e.getFullYear(),0,1).toISOString().split("T")[0],toDate:new Date(e.getFullYear(),11,31).toISOString().split("T")[0]})})(),j(!1)},className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 text-blue-700 dark:text-blue-300 px-3 py-2.5 md:px-4 md:py-3 rounded-lg hover:from-blue-500 hover:to-blue-600 hover:text-white dark:hover:from-blue-600 dark:hover:to-blue-700 transition-all font-semibold shadow-sm hover:shadow-md border border-blue-200 dark:border-blue-700 text-xs md:text-base",children:"Current Year"})]})]})]})}),(0,p.jsxs)("div",{className:"grid grid-cols-3 gap-2 md:gap-4 mb-3 md:mb-4",children:[(0,p.jsxs)("div",{className:"bg-blue-50/50 dark:bg-blue-900/10 p-2 md:p-4 rounded-lg",children:[(0,p.jsx)("div",{className:"text-[10px] md:text-xs font-medium text-blue-600 dark:text-blue-400 mb-0.5 md:mb-1 uppercase tracking-wide",children:"Budgeted"}),(0,p.jsxs)("div",{className:"text-sm md:text-2xl font-bold text-blue-700 dark:text-blue-300",children:["$",new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Y)]})]}),(0,p.jsxs)("div",{className:"bg-orange-50/50 dark:bg-orange-900/10 p-2 md:p-4 rounded-lg",children:[(0,p.jsx)("div",{className:"text-[10px] md:text-xs font-medium text-orange-600 dark:text-orange-400 mb-0.5 md:mb-1 uppercase tracking-wide",children:"Spent"}),(0,p.jsxs)("div",{className:"text-sm md:text-2xl font-bold text-orange-700 dark:text-orange-300",children:["$",new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(B)]})]}),(0,p.jsxs)("div",{className:"p-2 md:p-4 rounded-lg ".concat(E>100?"bg-red-50/50 dark:bg-red-900/10":"bg-green-50/50 dark:bg-green-900/10"),children:[(0,p.jsx)("div",{className:"text-[10px] md:text-xs font-medium mb-0.5 md:mb-1 uppercase tracking-wide ".concat(E>100?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"),children:"Usage"}),(0,p.jsxs)("div",{className:"text-sm md:text-2xl font-bold ".concat(E>100?"text-red-700 dark:text-red-300":"text-green-700 dark:text-green-300"),children:[E.toFixed(1),"%"]}),(0,p.jsx)("div",{className:"mt-1 md:mt-2",children:(0,p.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1 md:h-1.5 overflow-hidden",children:(0,p.jsx)("div",{className:"h-1 md:h-1.5 rounded-full transition-all duration-500 ".concat(E>100?"bg-red-600 dark:bg-red-500":"bg-green-600 dark:bg-green-500"),style:{width:"".concat(Math.min(E,100),"%")}})})})]})]}),(0,p.jsxs)("div",{className:"w-full bg-white dark:bg-slate-800 rounded-xl shadow-xl p-3 md:p-6 border border-gray-200 dark:border-gray-700",children:[(0,p.jsxs)("div",{className:"flex items-center justify-between mb-3 md:mb-5",children:[(0,p.jsxs)("div",{className:"flex items-center gap-1.5 md:gap-3",children:[(0,p.jsx)("div",{className:"inline-flex items-center justify-center w-8 h-8 md:w-10 md:h-10 rounded-lg bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-400 shadow-sm",children:(0,p.jsx)(g.A,{size:16,className:"md:w-5 md:h-5"})}),(0,p.jsx)("h3",{className:"text-sm md:text-xl font-bold text-gray-800 dark:text-white",children:"Budget vs. Spending"})]}),(0,p.jsxs)("div",{className:"flex items-center gap-2",children:[(0,p.jsxs)("button",{onClick:()=>j(!0),className:"flex items-center gap-1.5 px-2.5 py-1.5 md:px-3 md:py-2 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-900/50 rounded-lg transition-all border border-blue-200 dark:border-blue-700 shadow-sm hover:shadow-md",title:"Change date range",children:[(0,p.jsx)(c.A,{size:14,className:"md:w-4 md:h-4"}),(0,p.jsx)("span",{className:"text-xs md:text-sm font-medium",children:"Date"})]}),(0,p.jsxs)("button",{onClick:()=>v(!0),className:"flex items-center gap-1.5 px-2.5 py-1.5 md:px-3 md:py-2 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 hover:bg-indigo-100 dark:hover:bg-indigo-900/50 rounded-lg transition-all border border-indigo-200 dark:border-indigo-700 shadow-sm hover:shadow-md",title:"Toggle category visibility",children:[(0,p.jsx)(u,{size:14,className:"md:w-4 md:h-4"}),(0,p.jsx)("span",{className:"text-xs md:text-sm font-medium",children:"Categories"})]})]})]}),(0,p.jsx)("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-3 md:p-4",children:(0,p.jsx)("div",{className:"h-80 md:h-96 w-full",children:M?(0,p.jsxs)("div",{className:"h-full w-full flex flex-col items-center justify-center gap-4",children:[(0,p.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-200 border-t-blue-600 dark:border-blue-800 dark:border-t-blue-400"}),(0,p.jsx)("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"Loading chart data..."})]}):0===N.labels.length?(0,p.jsxs)("div",{className:"h-full w-full flex flex-col items-center justify-center gap-4",children:[(0,p.jsx)(g.A,{className:"w-16 h-16 text-gray-300 dark:text-gray-600"}),(0,p.jsx)("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No budget data to display"}),(0,p.jsx)("p",{className:"text-gray-400 dark:text-gray-500 text-sm",children:"Add budget items to see the comparison"})]}):(0,p.jsx)(s.yP,{data:N,options:T,plugins:[l.A]})})})]}),y&&(0,p.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50 backdrop-blur-sm",onClick:()=>v(!1),children:(0,p.jsxs)("div",{className:"w-full max-w-2xl bg-white dark:bg-slate-800 rounded-xl p-4 md:p-6 shadow-2xl border border-gray-200 dark:border-gray-700 max-h-[80vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,p.jsxs)("div",{className:"flex items-center justify-between mb-4 md:mb-5",children:[(0,p.jsxs)("div",{className:"flex items-center gap-2 md:gap-3",children:[(0,p.jsx)("div",{className:"inline-flex items-center justify-center w-8 h-8 md:w-10 md:h-10 rounded-lg bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-400 shadow-sm",children:(0,p.jsx)(u,{size:16,className:"md:w-5 md:h-5"})}),(0,p.jsxs)("div",{children:[(0,p.jsx)("h2",{className:"text-base md:text-xl font-bold text-gray-800 dark:text-white",children:"Category Visibility"}),(0,p.jsxs)("span",{className:"text-xs md:text-sm text-gray-500 dark:text-gray-400 font-medium",children:[C.filter((e=>!e.hidden)).length," of ",C.length," visible"]})]})]}),(0,p.jsx)("button",{onClick:()=>v(!1),className:"p-2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-all",children:(0,p.jsx)(b.A,{size:20})})]}),C.length>0?(0,p.jsx)("div",{className:"flex flex-wrap gap-2 md:gap-3",children:C.map((e=>(0,p.jsxs)("button",{onClick:()=>(async e=>{const t=C.find((t=>t.id===e));if(!t)return;const{error:r}=await i.A.from("budget_items").update({hidden:!t.hidden}).eq("id",e).eq("user_id",k);r&&console.error("Error updating visibility:",r)})(e.id),className:"px-3 py-2 md:px-4 md:py-2.5 rounded-lg flex items-center gap-1.5 md:gap-2 text-xs md:text-sm font-semibold transition-all shadow-sm hover:shadow-md ".concat(e.hidden?"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 border-2 border-gray-300 dark:border-gray-600":"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 text-blue-700 dark:text-blue-300 hover:from-blue-100 hover:to-blue-200 dark:hover:from-blue-800/40 dark:hover:to-blue-700/40 border-2 border-blue-300 dark:border-blue-600"),children:[e.hidden?(0,p.jsx)(h,{size:14,className:"md:w-4 md:h-4 text-gray-500 dark:text-gray-400"}):(0,p.jsx)(u,{size:14,className:"md:w-4 md:h-4 text-blue-600 dark:text-blue-400"}),(0,p.jsx)("span",{children:e.name})]},e.id)))}):(0,p.jsxs)("div",{className:"text-center py-6 md:py-8 bg-gray-50 dark:bg-slate-700 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-500",children:[(0,p.jsx)(g.A,{className:"w-10 h-10 md:w-12 md:h-12 mx-auto text-gray-400 dark:text-gray-500 mb-2 md:mb-3"}),(0,p.jsx)("p",{className:"text-sm md:text-base text-gray-500 dark:text-gray-400 font-medium",children:"No budget items found"}),(0,p.jsx)("p",{className:"text-xs md:text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Create budget items to track spending"})]})]})})]})}},4183:(e,t,r)=>{r.d(t,{A:()=>a});const a=(0,r(1114).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},3500:(e,t,r)=>{r.d(t,{A:()=>a});const a=(0,r(1114).A)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},7669:(e,t,r)=>{r.d(t,{A:()=>a});const a=(0,r(1114).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}}]);
//# sourceMappingURL=649.d1e1e3e4.chunk.js.map