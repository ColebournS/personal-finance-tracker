{"version":3,"file":"static/js/88.57d5760b.chunk.js","mappings":"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","sources":["components/BulkPurchaseImport.js","components/SettingsButton.js"],"sourcesContent":["import React, { useState, useRef } from \"react\";\nimport { Upload, X, Save, AlertCircle } from \"lucide-react\";\nimport supabase from \"../supabaseClient.js\";\nimport { useData } from \"../DataContext\";\n\nconst BulkPurchaseImport = () => {\n  const { userId, refetchPurchases } = useData();\n  const dialogRef = useRef(null);\n  const [rawData, setRawData] = useState(\"\");\n  const [mappings, setMappings] = useState({\n    itemName: \"\",\n    cost: \"\",\n    date: \"\",\n  });\n  const [preview, setPreview] = useState([]);\n  const [headers, setHeaders] = useState([]);\n  const [error, setError] = useState(\"\");\n\n  const detectDelimiter = (text) => {\n    const firstLine = text.split(\"\\n\")[0];\n    if (!firstLine) return null;\n\n    const delimiters = [\"\\t\", \",\", \";\"];\n    const counts = delimiters.map((d) => ({\n      delimiter: d,\n      count: (firstLine.match(new RegExp(d, \"g\")) || []).length,\n    }));\n\n    const mostLikely = counts.reduce(\n      (max, curr) => (curr.count > max.count ? curr : max),\n      { delimiter: null, count: 0 }\n    );\n\n    return mostLikely.count > 0 ? mostLikely.delimiter : null;\n  };\n\n  const parseData = (raw) => {\n    try {\n      if (!raw.trim()) {\n        setError(\"No data provided\");\n        return;\n      }\n\n      const delimiter = detectDelimiter(raw);\n      if (!delimiter) {\n        setError(\n          \"Could not detect a valid delimiter (tab, comma, or semicolon)\"\n        );\n        return;\n      }\n\n      const lines = raw\n        .trim()\n        .split(\"\\n\")\n        .map((line) => line.trim());\n      if (lines.length < 2) {\n        setError(\"At least two lines are required (headers and data)\");\n        return;\n      }\n\n      const headers = lines[0].split(delimiter).map((h) => h.trim());\n      if (headers.length < 2) {\n        setError(\n          `Only found ${headers.length} column(s). Please check the format.`\n        );\n        return;\n      }\n\n      const data = lines.slice(1).map((line) => {\n        const values = line.split(delimiter).map((v) => v.trim());\n        return headers.reduce((obj, header, index) => {\n          obj[header] = values[index] || \"\";\n          return obj;\n        }, {});\n      });\n\n      setHeaders(headers);\n      setPreview(data);\n      setError(\"\");\n    } catch (err) {\n      console.error(\"Parsing error:\", err);\n      setError(`Parsing error: ${err.message}`);\n      setPreview([]);\n    }\n  };\n\n  const handlePaste = (e) => {\n    const text = e.target.value;\n    setRawData(text);\n    parseData(text);\n  };\n\n  const handleMapping = (field, header) => {\n    setMappings((prev) => ({\n      ...prev,\n      [field]: header,\n    }));\n  };\n\n  const validateMapping = () => {\n    if (!mappings.itemName) return \"Item Name mapping is required\";\n    if (!mappings.cost) return \"Cost mapping is required\";\n    return null;\n  };\n\n  const formatDate = (dateStr) => {\n    if (!dateStr) return new Date().toISOString();\n\n    // Try parsing the date string\n    const parsedDate = new Date(dateStr);\n\n    // Check if the date is valid\n    if (isNaN(parsedDate.getTime())) {\n      return new Date().toISOString();\n    }\n\n    return parsedDate.toISOString();\n  };\n\n  const handleImport = async () => {\n    const validationError = validateMapping();\n    if (validationError) {\n      setError(validationError);\n      return;\n    }\n\n    try {\n      const purchases = preview\n        .map((row) => ({\n          item_name: row[mappings.itemName]?.trim() || \"\",\n          cost: parseFloat(row[mappings.cost]) || 0,\n          user_id: userId,\n          budget_item_id: null,\n          timestamp: formatDate(mappings.date ? row[mappings.date] : null),\n        }))\n        .filter((p) => p.item_name && !isNaN(p.cost));\n\n      const { error } = await supabase.from(\"purchases\").insert(purchases);\n\n      if (error) throw error;\n\n      alert(\"Purchases imported successfully!\");\n      dialogRef.current?.close();\n      setRawData(\"\");\n      setPreview([]);\n      setMappings({\n        itemName: \"\",\n        cost: \"\",\n        date: \"\",\n      });\n    } catch (error) {\n      console.error(\"Error importing purchases:\", error);\n      setError(\"Failed to import purchases. Please try again.\");\n    }\n  };\n\n  return (\n    <>\n      <button\n        onClick={() => dialogRef.current?.showModal()}\n        className=\"w-full bg-green-500 text-white py-2 rounded-md hover:bg-green-600 transition-colors flex items-center justify-center mt-4\"\n      >\n        <Upload className=\"mr-2\" size={20} />\n        Bulk Import\n      </button>\n\n      <dialog\n        ref={dialogRef}\n        className=\"w-full max-w-3xl rounded-lg p-6 backdrop:bg-black backdrop:bg-opacity-50\"\n      >\n        <div className=\"space-y-4\">\n          <div className=\"flex justify-between items-center\">\n            <h2 className=\"text-xl font-bold\">Bulk Import Purchases</h2>\n            <button\n              onClick={() => dialogRef.current?.close()}\n              className=\"text-gray-500 hover:text-gray-700\"\n            >\n              <X size={20} />\n            </button>\n          </div>\n\n          {error && (\n            <div className=\"bg-red-50 border-l-4 border-red-400 p-4 text-red-700\">\n              <div className=\"flex\">\n                <AlertCircle className=\"h-5 w-5 mr-2\" />\n                <span>{error}</span>\n              </div>\n            </div>\n          )}\n\n          <div>\n            <label className=\"block text-sm font-medium mb-2\">\n              Paste your data (tab, comma, or semicolon separated):\n            </label>\n            <div className=\"text-xs text-gray-500 mb-2\">\n              Example format:\n              <br />\n              Item Name,Cost,Date\n              <br />\n              Groceries,45.99,2024-02-14\n            </div>\n            <textarea\n              value={rawData}\n              onChange={handlePaste}\n              className=\"w-full h-32 p-2 border rounded-md font-mono text-sm\"\n              placeholder=\"Item Name,Cost,Date\"\n            />\n          </div>\n\n          {headers.length > 0 && (\n            <div className=\"space-y-4\">\n              <h3 className=\"font-medium\">Map Columns</h3>\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm mb-1\">Item Name*</label>\n                  <select\n                    value={mappings.itemName}\n                    onChange={(e) => handleMapping(\"itemName\", e.target.value)}\n                    className=\"w-full p-2 border rounded-md\"\n                  >\n                    <option value=\"\">Select column</option>\n                    {headers.map((h) => (\n                      <option key={h} value={h}>\n                        {h}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-sm mb-1\">Cost*</label>\n                  <select\n                    value={mappings.cost}\n                    onChange={(e) => handleMapping(\"cost\", e.target.value)}\n                    className=\"w-full p-2 border rounded-md\"\n                  >\n                    <option value=\"\">Select column</option>\n                    {headers.map((h) => (\n                      <option key={h} value={h}>\n                        {h}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-sm mb-1\">Date (Optional)</label>\n                  <select\n                    value={mappings.date}\n                    onChange={(e) => handleMapping(\"date\", e.target.value)}\n                    className=\"w-full p-2 border rounded-md\"\n                  >\n                    <option value=\"\">Select column</option>\n                    {headers.map((h) => (\n                      <option key={h} value={h}>\n                        {h}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n              </div>\n\n              {preview.length > 0 && (\n                <div>\n                  <h3 className=\"font-medium mb-2\">\n                    Preview ({preview.length} rows)\n                  </h3>\n                  <div className=\"max-h-48 overflow-auto border rounded-md\">\n                    <table className=\"min-w-full divide-y divide-gray-200\">\n                      <thead className=\"bg-gray-50\">\n                        <tr>\n                          {headers.map((header) => (\n                            <th\n                              key={header}\n                              className=\"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                            >\n                              {header}\n                            </th>\n                          ))}\n                        </tr>\n                      </thead>\n                      <tbody className=\"bg-white divide-y divide-gray-200\">\n                        {preview.slice(0, 5).map((row, idx) => (\n                          <tr key={idx}>\n                            {headers.map((header) => (\n                              <td key={header} className=\"px-4 py-2 text-sm\">\n                                {row[header]}\n                              </td>\n                            ))}\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          <div className=\"flex justify-end space-x-2 mt-4 pt-4 border-t\">\n            <button\n              onClick={() => dialogRef.current?.close()}\n              className=\"px-4 py-2 border rounded-md hover:bg-gray-100\"\n            >\n              <X className=\"mr-2 inline-block\" size={16} />\n              Cancel\n            </button>\n            <button\n              onClick={handleImport}\n              disabled={!preview.length || !mappings.itemName || !mappings.cost}\n              className=\"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              <Save className=\"mr-2 inline-block\" size={16} />\n              Import\n            </button>\n          </div>\n        </div>\n      </dialog>\n    </>\n  );\n};\n\nexport default BulkPurchaseImport;\n","import React, { useState, useEffect, useRef } from \"react\";\nimport { Settings, Download, LogOut } from \"lucide-react\";\nimport * as XLSX from \"xlsx\";\nimport supabase from \"../supabaseClient\";\nimport BulkPurchaseImport from \"./BulkPurchaseImport\";\n\nconst SettingsButton = ({\n  onToggleIncome = () => {},\n  onToggleRecommended = () => {},\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [hideIncome, setHideIncome] = useState(false);\n  const [hideRecommended, setHideRecommended] = useState(false);\n  const popupRef = useRef(null);\n  const [userId, setUserId] = useState(null);\n\n  useEffect(() => {\n    const getCurrentUser = async () => {\n      const {\n        data: { user },\n      } = await supabase.auth.getUser();\n      if (user) {\n        setUserId(user.id);\n      }\n    };\n    getCurrentUser();\n  }, []);\n\n  useEffect(() => {\n    if (userId) {\n      fetchProfileData();\n\n      const profileChannel = supabase\n        .channel(`profile_changes_${userId}`)\n        .on(\n          \"postgres_changes\",\n          {\n            event: \"*\",\n            schema: \"public\",\n            table: \"profiles\",\n            match: { id: userId },\n          },\n          () => fetchProfileData()\n        )\n        .subscribe();\n\n      return () => {\n        profileChannel.unsubscribe();\n      };\n    }\n  }, [userId]);\n\n  const fetchProfileData = async () => {\n    try {\n      const { data, error } = await supabase\n        .from(\"profiles\")\n        .select(\"hide_income, hide_recommended_budget\")\n        .eq(\"id\", userId)\n        .single();\n\n      if (error) {\n        console.error(\"Error fetching profile data:\", error);\n        return;\n      }\n\n      if (data) {\n        setHideIncome(data.hide_income || false);\n        setHideRecommended(data.hide_recommended_budget || false);\n        onToggleIncome(!data.hide_income);\n        onToggleRecommended(!data.hide_recommended_budget);\n      }\n    } catch (err) {\n      console.error(\"Unexpected error:\", err);\n    }\n  };\n\n  const updateProfile = async (updates) => {\n    try {\n      const { error } = await supabase\n        .from(\"profiles\")\n        .update(updates)\n        .eq(\"id\", userId);\n\n      if (error) {\n        console.error(\"Error updating profile:\", error);\n      }\n    } catch (err) {\n      console.error(\"Unexpected error:\", err);\n    }\n  };\n\n  const handleIncomeToggle = async () => {\n    const newValue = !hideIncome;\n    setHideIncome(newValue);\n    onToggleIncome(!newValue);\n    await updateProfile({ hide_income: newValue });\n  };\n\n  const handleRecommendedToggle = async () => {\n    const newValue = !hideRecommended;\n    setHideRecommended(newValue);\n    onToggleRecommended(!newValue);\n    await updateProfile({ hide_recommended_budget: newValue });\n  };\n\n  const handleSignOut = async () => {\n    try {\n      const { error } = await supabase.auth.signOut();\n      if (error) throw error;\n      // The page will likely need to refresh or redirect after sign out\n      window.location.href = \"/\";\n    } catch (error) {\n      console.error(\"Error signing out:\", error);\n    }\n  };\n\n  const exportToExcel = async () => {\n    try {\n      const { data: budgetGroups, error: groupsError } = await supabase\n        .from(\"budget_groups\")\n        .select(\"*\")\n        .eq(\"id\", userId);\n\n      if (groupsError) throw groupsError;\n\n      const { data: budgetItems, error: itemsError } = await supabase\n        .from(\"budget_items\")\n        .select(\"*\")\n        .eq(\"id\", userId);\n\n      if (itemsError) throw itemsError;\n\n      const { data: purchases, error: purchasesError } = await supabase\n        .from(\"purchases\")\n        .select(\"*\")\n        .eq(\"id\", userId);\n\n      if (purchasesError) throw purchasesError;\n\n      const budgetItemsData = budgetItems.map((item) => {\n        const group = budgetGroups.find((g) => g.id === item.group_id);\n        return {\n          Group: group?.name || \"Unknown\",\n          ItemName: item.name,\n          Budget: item.budget,\n          ItemID: item.id,\n        };\n      });\n\n      const purchasesData = purchases.map((purchase) => ({\n        ItemName: purchase.item_name,\n        Cost: purchase.cost,\n        BudgetGroup: purchase.budget_item_id,\n        Timestamp: new Date(purchase.timestamp).toLocaleString(),\n      }));\n\n      const workbook = XLSX.utils.book_new();\n\n      const budgetItemsSheet = XLSX.utils.json_to_sheet(budgetItemsData);\n      XLSX.utils.book_append_sheet(workbook, budgetItemsSheet, \"Budget Items\");\n\n      const purchasesSheet = XLSX.utils.json_to_sheet(purchasesData);\n      XLSX.utils.book_append_sheet(workbook, purchasesSheet, \"Purchases\");\n\n      const groupsSheet = XLSX.utils.json_to_sheet(budgetGroups);\n      XLSX.utils.book_append_sheet(workbook, groupsSheet, \"Budget Groups\");\n\n      XLSX.writeFile(workbook, \"Budget_Export.xlsx\");\n    } catch (error) {\n      console.error(\"Error exporting data to Excel: \", error);\n      throw error;\n    }\n  };\n\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (popupRef.current && !popupRef.current.contains(event.target)) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\n  }, []);\n\n  return (\n    <div className=\"fixed top-2 right-2 z-50\">\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"p-4 rounded-md bg-blue-200 hover:bg-blue-400 shadow-md transition-colors\"\n        aria-label=\"Settings\"\n      >\n        <Settings className=\"w-6 h-6 text-gray-700\" />\n      </button>\n\n      {isOpen && (\n        <div\n          ref={popupRef}\n          className=\"absolute right-0 mt-2 w-80 rounded-lg bg-white shadow-lg ring-1 ring-black ring-opacity-5\"\n        >\n          <div className=\"p-4\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h2 className=\"text-lg font-semibold text-gray-900\">Settings</h2>\n              <button\n                onClick={() => setIsOpen(false)}\n                className=\"text-gray-400 hover:text-gray-500\"\n              >\n                <span className=\"sr-only\">Close</span>\n                <svg\n                  className=\"h-6 w-6\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  stroke=\"currentColor\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M6 18L18 6M6 6l12 12\"\n                  />\n                </svg>\n              </button>\n            </div>\n\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-between p-2 hover:bg-gray-50 rounded-md\">\n                <div>\n                  <h3 className=\"text-sm font-medium text-gray-900\">\n                    Hide Income\n                  </h3>\n                  <p className=\"text-sm text-gray-500\">\n                    Toggle income visibility\n                  </p>\n                </div>\n                <label className=\"relative inline-flex items-center cursor-pointer\">\n                  <input\n                    type=\"checkbox\"\n                    checked={hideIncome}\n                    onChange={handleIncomeToggle}\n                    className=\"sr-only peer\"\n                  />\n                  <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600\"></div>\n                </label>\n              </div>\n\n              <div className=\"flex items-center justify-between p-2 hover:bg-gray-50 rounded-md\">\n                <div>\n                  <h3 className=\"text-sm font-medium text-gray-900\">\n                    Hide Recommended Budget\n                  </h3>\n                  <p className=\"text-sm text-gray-500\">\n                    Toggle recommended budget visibility\n                  </p>\n                </div>\n                <label className=\"relative inline-flex items-center cursor-pointer\">\n                  <input\n                    type=\"checkbox\"\n                    checked={hideRecommended}\n                    onChange={handleRecommendedToggle}\n                    className=\"sr-only peer\"\n                  />\n                  <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600\"></div>\n                </label>\n              </div>\n\n              <button\n                onClick={exportToExcel}\n                className=\"w-full flex items-center justify-center gap-2 p-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md transition-colors\"\n              >\n                <Download className=\"w-4 h-4\" />\n                Export Data\n              </button>\n              \n              <BulkPurchaseImport />\n\n              <div className=\"border-t border-gray-200 pt-4\">\n                <button\n                  onClick={handleSignOut}\n                  className=\"w-full flex items-center justify-center gap-2 p-2 text-sm font-medium text-red-600 hover:text-red-700 hover:bg-red-50 rounded-md transition-colors\"\n                >\n                  <LogOut className=\"w-4 h-4\" />\n                  Sign Out\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default SettingsButton;\n"],"names":["BulkPurchaseImport","userId","refetchPurchases","useData","dialogRef","useRef","rawData","setRawData","useState","mappings","setMappings","itemName","cost","date","preview","setPreview","headers","setHeaders","error","setError","parseData","raw","trim","delimiter","text","firstLine","split","mostLikely","map","d","count","match","RegExp","length","reduce","max","curr","detectDelimiter","lines","line","h","concat","data","slice","values","v","obj","header","index","err","console","message","handleMapping","field","prev","_objectSpread","formatDate","dateStr","Date","toISOString","parsedDate","isNaN","getTime","_jsxs","_Fragment","children","onClick","_dialogRef$current2","current","showModal","className","_jsx","Upload","size","ref","_dialogRef$current3","close","X","AlertCircle","value","onChange","e","target","placeholder","row","idx","_dialogRef$current4","async","validationError","_dialogRef$current","purchases","_row$mappings$itemNam","item_name","parseFloat","user_id","budget_item_id","timestamp","filter","p","supabase","from","insert","alert","disabled","Save","_ref","onToggleIncome","onToggleRecommended","isOpen","setIsOpen","hideIncome","setHideIncome","hideRecommended","setHideRecommended","popupRef","setUserId","useEffect","user","auth","getUser","id","getCurrentUser","fetchProfileData","profileChannel","channel","on","event","schema","table","subscribe","unsubscribe","select","eq","single","hide_income","hide_recommended_budget","updateProfile","update","updates","handleClickOutside","contains","document","addEventListener","removeEventListener","Settings","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","type","checked","newValue","budgetGroups","groupsError","budgetItems","itemsError","purchasesError","budgetItemsData","item","group","find","g","group_id","Group","name","ItemName","Budget","budget","ItemID","purchasesData","purchase","Cost","BudgetGroup","Timestamp","toLocaleString","workbook","XLSX","book_new","budgetItemsSheet","json_to_sheet","book_append_sheet","purchasesSheet","groupsSheet","Download","signOut","window","location","href","LogOut"],"sourceRoot":""}