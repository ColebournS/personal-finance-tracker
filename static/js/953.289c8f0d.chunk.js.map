{"version":3,"file":"static/js/953.289c8f0d.chunk.js","mappings":";yRAOA,MAiTA,EAjTuBA,KACrB,MAAOC,EAAQC,IAAaC,EAAAA,EAAAA,UAAS,OAC/B,MAAEC,EAAK,SAAEC,IAAaC,EAAAA,EAAAA,MACrBC,EAASC,IAAcL,EAAAA,EAAAA,WAAS,IAChCM,EAAoBC,IAAyBP,EAAAA,EAAAA,UAAS,OACtDQ,EAASC,IAAcT,EAAAA,EAAAA,WAAS,IAChCU,EAAcC,IAAmBX,EAAAA,EAAAA,UAAS,OAC1CY,EAAuBC,IAA4Bb,EAAAA,EAAAA,WAAS,IAEnEc,EAAAA,EAAAA,YAAU,KACRT,GAAW,EAAK,GACf,KAEHS,EAAAA,EAAAA,YAAU,KACeC,WACrB,MACEC,MAAM,KAAEC,UACAC,EAAAA,EAASC,KAAKC,UACxB,GAAIH,EAAM,CACRlB,EAAUkB,EAAKI,IAGf,MAAQL,KAAMM,SAAsBJ,EAAAA,EACjCK,KAAK,YACLC,OAAO,wBACPC,GAAG,KAAMR,EAAKI,IACdK,SAEH,GAAe,OAAXJ,QAAW,IAAXA,GAAAA,EAAaK,qBACf,IACE,MAAMC,GAAeC,EAAAA,EAAAA,IAAcP,EAAYK,qBAAsBV,EAAKI,IACtEO,GAAgBA,EAAaE,WAAW,SAC1CvB,EAAsBqB,EAE1B,CAAE,MAAOG,GACPC,QAAQD,MAAM,kCAAmCA,EACnD,CAEJ,GAEFE,EAAgB,GACf,IAEH,MA6FMC,EAA+BnB,UACnC,IAGE,MAAQC,KAAMmB,SAAwBjB,EAAAA,EACnCK,KAAK,aACLC,OAAO,8DACPC,GAAG,UAAW3B,IAGX,qBAAEsC,SAA+BC,EAAAA,EAAAA,IACrC/B,EACAgC,EACAH,GAAiB,IAGnB,GAAoC,IAAhCC,EAAqBG,OAEvB,YADAP,QAAQQ,IAAI,+BAIdR,QAAQQ,IAAI,WAADC,OAAYL,EAAqBG,OAAM,sBAGlD,IAAK,MAAMG,KAAeN,QAClBlB,EAAAA,EAASK,KAAK,aAAaoB,OAAO,EAAAC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACnCF,GAAW,IACdG,QAAS/C,MAIbkC,QAAQQ,IAAI,uBAADC,OAAwBL,EAAqBG,OAAM,iBAEhE,CAAE,MAAOR,GACPC,QAAQD,MAAM,0BAA2BA,EAE3C,GAgCF,OACEe,EAAAA,EAAAA,MAAA,OAAKC,UAAU,qEAAoEC,SAAA,EACjFC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,oEAAmEC,SAAC,cAGlFF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,YAAWC,SAAA,CACvB5C,IACC0C,EAAAA,EAAAA,MAAA,OAAKC,UAAU,4FAA2FC,SAAA,EACxGF,EAAAA,EAAAA,MAAA,OAAAE,SAAA,EACEC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,oDAAmDC,SAAC,eAGlEC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,2CAA0CC,SAAC,gCAI1DC,EAAAA,EAAAA,KAAA,UACEC,QAASA,IAAMhD,EAAmB,SAAVD,EAAmB,QAAU,QACrD8C,UAAU,2GACV,aAAW,eAAcC,SAEd,SAAV/C,GACCgD,EAAAA,EAAAA,KAACE,EAAAA,EAAG,CAACJ,UAAU,8CAEfE,EAAAA,EAAAA,KAACG,EAAAA,EAAI,CAACL,UAAU,kDAOvBzC,IACCwC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oEAAmEC,SAAA,EAChFC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,2DAA0DC,SAAC,oBAGzEF,EAAAA,EAAAA,MAAA,UACEI,QAtMgBnC,UAC1B,GAAKT,GAAuBR,EAA5B,CAEAW,GAAW,GAEX,IACE,MAAQO,KAAMqC,SAAuBnC,EAAAA,EAClCK,KAAK,YACLC,OAAO,KACPC,GAAG,UAAW3B,GAEXwD,GAAqBD,GAAgB,IAAIE,KAAIC,IAAOZ,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACrDY,GAAO,IACVC,OAAOC,EAAAA,EAAAA,IAAaF,EAAQC,MAAO3D,GACnC6D,eAAeD,EAAAA,EAAAA,IAAaF,EAAQG,cAAe7D,GACnD8D,qBAAqBF,EAAAA,EAAAA,IAAaF,EAAQI,oBAAqB9D,QAG3D,iBAAE+D,EAAgB,iBAAEC,SAA2BC,EAAAA,EAAAA,IACnDzD,EACAgD,GAGFtB,QAAQQ,IAAI,gBAAiB,CAC3BwB,SAAUH,EAAiBtB,OAC3B0B,SAAUH,EAAiBvB,OAC3B2B,YAAaL,IAGf,MAAMM,EAAuB,GAE7B,IAAK,MAAMC,KAAcP,EAAkB,CACzC7B,QAAQQ,IAAI,wBAAyB4B,GACrC,MAAMC,GAAiBC,EAAAA,EAAAA,IAAaF,EAAWX,MAAO3D,GAChDyE,GAAwBD,EAAAA,EAAAA,IAAaF,EAAWT,cAAe7D,GAC/D0E,GAA+BF,EAAAA,EAAAA,IAAaF,EAAWR,oBAAqB9D,IAE5E,KAAEkB,EAAI,MAAEe,SAAgBb,EAAAA,EAASK,KAAK,YAAYoB,OAAO,EAAAC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAC1DwB,GAAU,IACbX,MAAOY,EACPV,cAAeY,EACfX,oBAAqBY,EACrB3B,QAAS/C,MACP0B,SAEJ,GAAIO,EAEF,MADAC,QAAQD,MAAM,2BAA4BA,GACpCA,EAERC,QAAQQ,IAAI,gCAAiCxB,GACzCA,GAAQA,EAAK,IACfmD,EAAqBM,MAAI7B,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EACtB5B,EAAK,IAAE,IACVyC,MAAOW,EAAWX,MAClBE,cAAeS,EAAWT,cAC1BC,oBAAqBQ,EAAWR,sBAGtC,CAEA,IAAK,MAAMc,KAAkBZ,EAAkB,CAC7C,MAAMO,GAAiBC,EAAAA,EAAAA,IAAaI,EAAejB,MAAO3D,GACpDyE,GAAwBD,EAAAA,EAAAA,IAAaI,EAAef,cAAe7D,GACnE0E,GAA+BF,EAAAA,EAAAA,IAAaI,EAAed,oBAAqB9D,SAEhFoB,EAAAA,EACHK,KAAK,YACLoD,OAAO,CACNlB,MAAOY,EACPV,cAAeY,EACfX,oBAAqBY,EACrBI,aAAcF,EAAeE,aAC7BC,KAAMH,EAAeG,KACrBC,YAAaJ,EAAeI,YAC5BC,qBAAqB,IAEtBtD,GAAG,KAAMiD,EAAerD,GAC7B,CAGA,MAAM2D,EAAc,IAAI1B,KAAsBa,SACxCjC,EAA6B8C,GAEnCrE,EAAgB,IAAIsE,KAEtB,CAAE,MAAOlD,GACPC,QAAQD,MAAM,wBAAyBA,GACvCmD,MAAM,6CACR,CAAC,QACCzE,GAAW,EACb,CAzF0C,CAyF1C,EA6GU0E,SAAU3E,EACVuC,UAAU,8MAA6MC,SAAA,EAEvNC,EAAAA,EAAAA,KAACmC,EAAAA,EAAS,CAACrC,UAAS,WAAAN,OAAajC,EAAU,eAAiB,MAC3DA,EAAU,aAAe,uBAE3BE,IACCoC,EAAAA,EAAAA,MAAA,KAAGC,UAAU,uDAAsDC,SAAA,CAAC,gBACpDtC,EAAa2E,yBAG/BvC,EAAAA,EAAAA,MAAA,UACEI,QAASA,IAAMrC,GAAyB,GACxCkC,UAAU,6NAA4NC,SAAA,EAEtOC,EAAAA,EAAAA,KAACqC,EAAAA,EAAK,CAACvC,UAAU,YAAY,8BAMnCE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,qDAAoDC,UACjEF,EAAAA,EAAAA,MAAA,UACEI,QA1EYnC,UACpB,IACE,MAAM,MAAEgB,SAAgBb,EAAAA,EAASC,KAAKoE,UACtC,GAAIxD,EAAO,MAAMA,EAEjByD,OAAOC,SAASC,KAAO,GACzB,CAAE,MAAO3D,GACPC,QAAQD,MAAM,qBAAsBA,EACtC,GAmEQgB,UAAU,wNAAuNC,SAAA,EAEjOC,EAAAA,EAAAA,KAAC0C,EAAAA,EAAM,CAAC5C,UAAU,YAAY,mBAOnCnC,IACCqC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,iFAAgFC,UAC7FF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uEAAsEC,SAAA,EACnFC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,uDAAsDC,SAAC,2BAGrEC,EAAAA,EAAAA,KAAA,KAAGF,UAAU,wCAAuCC,SAAC,iJAGrDF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,aAAYC,SAAA,EACzBC,EAAAA,EAAAA,KAAA,UACEC,QAASA,IAAMrC,GAAyB,GACxCkC,UAAU,uKAAsKC,SACjL,YAGDC,EAAAA,EAAAA,KAAA,UACEC,QArHoBnC,UAChC,UACQG,EAAAA,EACHK,KAAK,YACLoD,OAAO,CAAEhD,qBAAsB,OAC/BF,GAAG,KAAM3B,GAEZS,EAAsB,MACtBI,EAAgB,MAChBE,GAAyB,EAC3B,CAAE,MAAOkB,GACPC,QAAQD,MAAM,iCAAkCA,GAChDmD,MAAM,kCACR,GAyGYnC,UAAU,2IAA0IC,SACrJ,yBAOL,oEC1SHjC,eAAe6E,EAAeC,GACnC,IAEE,MAAMC,EAAWC,KAAKF,EAAWG,QAEjC,IAAKF,EAAShE,WAAW,QACvB,MAAM,IAAImE,MAAM,8BAIlB,MAAMC,EAAcC,2CACdC,EAAcD,mNAEdE,QAAiBC,MAAM,GAAD7D,OAAIyD,EAAW,iCAAiC,CAC1EK,OAAQ,OACRC,QAAS,CACP,eAAgB,mBAChB,cAAgB,UAAD/D,OAAY2D,IAE7BK,KAAMC,KAAKC,UAAU,CAAEC,IAAKd,EAAUS,OAAQ,WAG1CM,QAAqBR,EAASS,OAEpC,IAAKT,EAASU,GAAI,CAChB,GAAwB,MAApBV,EAASW,OACX,MAAM,IAAIf,MAAM,sEAElB,MAAM,IAAIA,MAAM,wBAADxD,OAAyB4D,EAASW,OAAM,OAAAvE,OAAMoE,GAC/D,CAEA,MAAM7F,EAAO6F,EAGb,IAAK7F,IAASA,EAAKc,WAAW,QAC5B,MAAM,IAAImE,MAAM,mCAGlB,OAAOjF,EAAKgF,MACd,CAAE,MAAOjE,GACP,GAAsB,eAAlBA,EAAMkF,QACR,MAAMlF,EAER,GAAmB,0BAAfA,EAAMmF,KACR,MAAM,IAAIjB,MAAM,oDAElB,MAAM,IAAIA,MAAM,+BAADxD,OAAgCV,EAAMkF,SACvD,CACF,CAUOlG,eAAeoG,EAAcC,GAA0B,IAAfC,EAAOC,UAAA/E,OAAA,QAAAgF,IAAAD,UAAA,GAAAA,UAAA,GAAG,CAAC,EACxD,IACE,IAAKF,IAAcA,EAAUtF,WAAW,QACtC,MAAM,IAAImE,MAAM,sBAIlB,IAAIuB,EAAW,GAAA/E,OAAM2E,EAAS,aAG9B,MAAMK,EAAS,GACXJ,EAAQK,WACVD,EAAOhD,KAAK,cAADhC,OAAe4E,EAAQK,YAEhCL,EAAQM,SACVF,EAAOhD,KAAK,YAADhC,OAAa4E,EAAQM,UAE9BF,EAAOlF,OAAS,IAClBiF,GAAW,IAAA/E,OAAQgF,EAAOG,KAAK,OAIjC,MAAM1B,EAAcC,2CACdC,EAAcD,mNAEdE,QAAiBC,MAAM,GAAD7D,OAAIyD,EAAW,iCAAiC,CAC1EK,OAAQ,OACRC,QAAS,CACP,eAAgB,mBAChB,cAAgB,UAAD/D,OAAY2D,IAE7BK,KAAMC,KAAKC,UAAU,CAAEC,IAAKY,EAAajB,OAAQ,UAGnD,IAAKF,EAASU,GAAI,CAChB,GAAwB,MAApBV,EAASW,OAAgB,CAE3B,MAAMa,EAAaxB,EAASG,QAAQsB,IAAI,eACxC,MAAM,IAAI7B,MAAM,cAADxD,OAAeoF,GAAc,MAC9C,CACA,GAAwB,MAApBxB,EAASW,QAAsC,MAApBX,EAASW,OACtC,MAAM,IAAIf,MAAM,+EAElB,MAAM,IAAIA,MAAM,6BAADxD,OAA8B4D,EAAS0B,YACxD,CAGA,aADmB1B,EAAS2B,MAE9B,CAAE,MAAOjG,GACP,GAAIA,EAAMkF,QAAQnF,WAAW,eAAiBC,EAAMkF,QAAQnF,WAAW,gBACrE,MAAMC,EAER,MAAM,IAAIkE,MAAM,6BAADxD,OAA8BV,EAAMkF,SACrD,CACF,CAOO,SAASgB,EAAoBC,GAAY,IAADC,EAE7C,IAAIC,EAAU,OACYb,IAAtBW,EAAUE,SAA+C,OAAtBF,EAAUE,UAC/CA,EAAUC,WAAWH,EAAUE,UAIjB,IAAZA,QAAiDb,IAAhCW,EAAUI,mBAAmE,OAAhCJ,EAAUI,oBAC1EF,EAAUC,WAAWH,EAAUI,oBAIjC,IAAIC,EAAc,QAClB,MAAMC,GAA4B,QAAdL,EAAAD,EAAUhB,YAAI,IAAAiB,OAAA,EAAdA,EAAgBM,gBAAiB,GAsBrD,OAnBID,EAAYE,SAAS,aAAeF,EAAYE,SAAS,SAC3DH,EAAc,WACLC,EAAYE,SAAS,WAC9BH,EAAc,UACLC,EAAYE,SAAS,WAAaN,EAAU,EACrDG,EAAc,SACLC,EAAYE,SAAS,SAAWF,EAAYE,SAAS,YAC9DH,EAAc,QACLC,EAAYE,SAAS,eAAiBF,EAAYE,SAAS,cAC3DF,EAAYE,SAAS,SAAWF,EAAYE,SAAS,UAC9DH,EAAc,cAKI,WAAhBA,GAA4C,SAAhBA,IAC9BH,EAAUO,KAAKC,IAAIR,IAGd,CACLS,aAAcX,EAAU7G,GACxB6F,KAAMgB,EAAUhB,MAAQ,kBACxBtC,aAAc2D,EACd9E,MAAO2E,EACPrD,qBAAqB,EACrBD,aAAa,IAAIG,MAAO6D,cACxBnF,cAAe,EACfC,oBAAqB,EAEzB,CAQO7C,eAAegI,EAAiBC,GAA0B,IAC3DC,EAD0CC,EAAU5B,UAAA/E,OAAA,QAAAgF,IAAAD,UAAA,GAAAA,UAAA,GAAG,EAG3D,IAAK,IAAI6B,EAAU,EAAGA,EAAUD,EAAYC,IAC1C,IACE,aAAaH,GACf,CAAE,MAAOjH,GAIP,GAHAkH,EAAYlH,EAGRA,EAAMkF,QAAQnF,WAAW,iBACzBC,EAAMkF,QAAQyB,SAAS,wBACvB3G,EAAMkF,QAAQyB,SAAS,sBACzB,MAAM3G,EAIR,GAAIA,EAAMkF,QAAQnF,WAAW,cAAe,CAC1C,MAAMsH,EAAQrH,EAAMkF,QAAQoC,MAAM,KAC5BxB,EAAauB,EAAM7G,OAAS,EAAI+G,SAASF,EAAM,IAAM,GAE3D,GAAID,EAAUD,EAAa,EAAG,OAEtB,IAAIK,SAAQC,GAAWC,WAAWD,EAAsB,IAAb3B,KACjD,QACF,CACA,MAAM9F,CACR,CAGA,GAAIoH,EAAUD,EAAa,EAAG,CAC5B,MAAMQ,EAA+B,IAAvBf,KAAKgB,IAAI,EAAGR,SACpB,IAAII,SAAQC,GAAWC,WAAWD,EAASE,IACnD,CACF,CAGF,MAAMT,CACR,CASO,SAASW,EAAwBC,EAAeC,EAAWC,GAGhE,MAAMC,EAASrB,KAAKC,IAAIP,WAAWwB,EAAcG,SAAW,GAI5D,GAAIH,EAAcG,QAAU,GAAgB,IAAXA,EAC/B,OAAO,KAIT,IAAIC,EAAkB,IAAIhF,KAO1B,OANI4E,EAAcK,OAChBD,EAAkB,IAAIhF,KAA4B,IAAvB4E,EAAcK,QAChCL,EAAcM,gBACvBF,EAAkB,IAAIhF,KAAmC,IAA9B4E,EAAcM,gBAGpC,CACLC,yBAA0BP,EAAcxI,GACxCgJ,qBAAsBN,EACtBO,UAAWT,EAAcU,aAAeV,EAAcW,OAAS,sBAC/DC,KAAMT,EACNU,UAAWT,EAAgBnB,cAC3B/D,qBAAqB,EACrB4F,eAAgB,KAEpB,CAQO5J,eAAegD,EAAaqD,GAAmC,IAAxBwD,EAAgBtD,UAAA/E,OAAA,QAAAgF,IAAAD,UAAA,GAAAA,UAAA,GAAG,GAC/D,IAEE,MAAMtG,QAAa+H,GAAiB,IAAM5B,EAAcC,KAExD,IAAKpG,IAASA,EAAK6J,WAAaC,MAAMC,QAAQ/J,EAAK6J,UACjD,MAAM,IAAI5E,MAAM,0CAGlB,MAAMpC,EAAmB,GACnBC,EAAmB,GAGzB,IAAK,MAAMoE,KAAalH,EAAK6J,SAAU,CACrC,MAAMG,EAAgB/C,EAAoBC,GAGpC+C,EAAkBL,EAAiBM,MACvCC,GAAOA,EAAItC,eAAiBmC,EAAcnC,eAGxCoC,EAEFnH,EAAiBW,MAAI7B,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CACpBvB,GAAI4J,EAAgB5J,IACjB2J,GAAa,IAChBrH,cAAesH,EAAgBtH,cAC/BC,oBAAqBqH,EAAgBrH,oBACrCsD,KAAM+D,EAAgB/D,MAAQ8D,EAAc9D,QAI9CrD,EAAiBY,KAAKuG,EAE1B,CAEA,MAAO,CACLnH,mBACAC,mBACAsH,YAAapK,EAAK6J,SAAStI,OAC3B8I,QAASrK,EAEb,CAAE,MAAOe,GACP,MAAMA,CACR,CACF,CASOhB,eAAesB,EAAiB+E,GAAwD,IAA7CkE,EAAahE,UAAA/E,OAAA,QAAAgF,IAAAD,UAAA,GAAAA,UAAA,GAAG,GAAIiE,EAAiBjE,UAAA/E,OAAA,QAAAgF,IAAAD,UAAA,GAAAA,UAAA,GAAG,GACxF,IAEE,MAAMK,EAAUgB,KAAK6C,MAAMvG,KAAKwG,MAAQ,KAClC/D,EAAYC,EAAW,OAGvB3G,QAAa+H,GAAiB,IAAM5B,EAAcC,EAAW,CAAEM,YAAWC,cAEhF,IAAK3G,IAASA,EAAK6J,WAAaC,MAAMC,QAAQ/J,EAAK6J,UACjD,MAAM,IAAI5E,MAAM,0CAGlB,MAAM7D,EAAuB,GAIvBsJ,EAAyB,IAAIC,IACjCJ,EACGK,QAAOC,GAAKA,EAAEzB,2BACd7G,KAAIsI,GAAKA,EAAEzB,4BAIhB,IAAK,MAAMlC,KAAalH,EAAK6J,SAAU,CAErC,MAAMiB,EAAeR,EAAcJ,MACjCC,GAAOA,EAAItC,eAAiBX,EAAU7G,KAGxC,GAAKyK,IAKD5D,EAAU6D,cAAgBjB,MAAMC,QAAQ7C,EAAU6D,eACpD,IAAK,MAAMlC,KAAiB3B,EAAU6D,aAAc,CAElD,GAAIL,EAAuBM,IAAInC,EAAcxI,IAC3C,SAIF,MAAM4K,EAAoBrC,EACxBC,EACAiC,EAAazK,GACb6G,EAAU7G,IAIR4K,GACF7J,EAAqBqC,KAAKwH,EAE9B,CAEJ,CAEA,MAAO,CACL7J,uBACAgJ,YAAahJ,EAAqBG,OAEtC,CAAE,MAAOR,GACP,MAAMA,CACR,CACF,mCC7XO,MAiBD4D,GAASuG,UAAAA,GAAiB,SAjBI,CAClC,CAAC,OAAQ,CAAEC,EAAG,0CAA2CC,IAAK,WAC9D,CAAC,WAAY,CAAEC,OAAQ,mBAAoBD,IAAK,WAChD,CAAC,OAAQ,CAAEE,GAAI,KAAMC,GAAI,IAAKC,GAAI,KAAMC,GAAI,KAAML,IAAK,6CCHlD,MAeDhJ,GAAO8I,UAAAA,GAAiB,OAfM,CAClC,CAAC,OAAQ,CAAEC,EAAG,qCAAsCC,IAAK,8CCDpD,MAkBDhH,GAAY8G,UAAAA,GAAiB,YAlBC,CAClC,CAAC,OAAQ,CAAEC,EAAG,qDAAsDC,IAAK,WACzE,CAAC,OAAQ,CAAED,EAAG,aAAcC,IAAK,WACjC,CAAC,OAAQ,CAAED,EAAG,sDAAuDC,IAAK,WAC1E,CAAC,OAAQ,CAAED,EAAG,YAAaC,IAAK,8CCJ3B,MAuBDjJ,GAAM+I,UAAAA,GAAiB,MAvBO,CAClC,CAAC,SAAU,CAAEQ,GAAI,KAAMC,GAAI,KAAMC,EAAG,IAAKR,IAAK,WAC9C,CAAC,OAAQ,CAAED,EAAG,UAAWC,IAAK,WAC9B,CAAC,OAAQ,CAAED,EAAG,WAAYC,IAAK,WAC/B,CAAC,OAAQ,CAAED,EAAG,uBAAwBC,IAAK,WAC3C,CAAC,OAAQ,CAAED,EAAG,yBAA0BC,IAAK,WAC7C,CAAC,OAAQ,CAAED,EAAG,UAAWC,IAAK,WAC9B,CAAC,OAAQ,CAAED,EAAG,WAAYC,IAAK,WAC/B,CAAC,OAAQ,CAAED,EAAG,wBAAyBC,IAAK,WAC5C,CAAC,OAAQ,CAAED,EAAG,wBAAyBC,IAAK,8CCTvC,MAgBDS,GAAIX,UAAAA,GAAiB,IAhBS,CAClC,CAAC,OAAQ,CAAEC,EAAG,aAAcC,IAAK,WACjC,CAAC,OAAQ,CAAED,EAAG,aAAcC,IAAK","sources":["components/SettingsMobile.js","utils/simplefinService.js","../node_modules/lucide-react/src/icons/log-out.ts","../node_modules/lucide-react/src/icons/moon.ts","../node_modules/lucide-react/src/icons/refresh-cw.ts","../node_modules/lucide-react/src/icons/sun.ts","../node_modules/lucide-react/src/icons/x.ts"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { LogOut, Moon, Sun, RefreshCw, X as XIcon } from \"lucide-react\";\nimport supabase from \"../supabaseClient\";\nimport { useTheme } from \"next-themes\";\nimport { decryptString, encryptValue, decryptValue } from \"../utils/encryption\";\nimport { syncAccounts, syncTransactions } from \"../utils/simplefinService\";\n\nconst SettingsMobile = () => {\n  const [userId, setUserId] = useState(null);\n  const { theme, setTheme } = useTheme();\n  const [mounted, setMounted] = useState(false);\n  const [simpleFinAccessUrl, setSimpleFinAccessUrl] = useState(null);\n  const [syncing, setSyncing] = useState(false);\n  const [lastSyncTime, setLastSyncTime] = useState(null);\n  const [showDisconnectConfirm, setShowDisconnectConfirm] = useState(false);\n\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n\n  useEffect(() => {\n    const getCurrentUser = async () => {\n      const {\n        data: { user },\n      } = await supabase.auth.getUser();\n      if (user) {\n        setUserId(user.id);\n        \n        // Fetch SimpleFin access URL\n        const { data: profileData } = await supabase\n          .from(\"profiles\")\n          .select(\"simplefin_access_url\")\n          .eq(\"id\", user.id)\n          .single();\n        \n        if (profileData?.simplefin_access_url) {\n          try {\n            const decryptedUrl = decryptString(profileData.simplefin_access_url, user.id);\n            if (decryptedUrl && decryptedUrl.startsWith('http')) {\n              setSimpleFinAccessUrl(decryptedUrl);\n            }\n          } catch (error) {\n            console.error('Error decrypting SimpleFin URL:', error);\n          }\n        }\n      }\n    };\n    getCurrentUser();\n  }, []);\n\n  const handleSimpleFinSync = async () => {\n    if (!simpleFinAccessUrl || !userId) return;\n    \n    setSyncing(true);\n    \n    try {\n      const { data: accountsData } = await supabase\n        .from(\"accounts\")\n        .select(\"*\")\n        .eq(\"user_id\", userId);\n      \n      const decryptedAccounts = (accountsData || []).map(account => ({\n        ...account,\n        value: decryptValue(account.value, userId),\n        interest_rate: decryptValue(account.interest_rate, userId),\n        montly_contribution: decryptValue(account.montly_contribution, userId)\n      }));\n      \n      const { accountsToCreate, accountsToUpdate } = await syncAccounts(\n        simpleFinAccessUrl,\n        decryptedAccounts\n      );\n\n      console.log('Sync results:', {\n        toCreate: accountsToCreate.length,\n        toUpdate: accountsToUpdate.length,\n        newAccounts: accountsToCreate\n      });\n\n      const newlyCreatedAccounts = [];\n\n      for (const newAccount of accountsToCreate) {\n        console.log('Creating new account:', newAccount);\n        const encryptedValue = encryptValue(newAccount.value, userId);\n        const encryptedInterestRate = encryptValue(newAccount.interest_rate, userId);\n        const encryptedMonthlyContribution = encryptValue(newAccount.montly_contribution, userId);\n        \n        const { data, error } = await supabase.from(\"accounts\").insert([{\n          ...newAccount,\n          value: encryptedValue,\n          interest_rate: encryptedInterestRate,\n          montly_contribution: encryptedMonthlyContribution,\n          user_id: userId,\n        }]).select();\n        \n        if (error) {\n          console.error('Error inserting account:', error);\n          throw error;\n        }\n        console.log('Account created successfully:', data);\n        if (data && data[0]) {\n          newlyCreatedAccounts.push({\n            ...data[0],\n            value: newAccount.value,\n            interest_rate: newAccount.interest_rate,\n            montly_contribution: newAccount.montly_contribution\n          });\n        }\n      }\n\n      for (const updatedAccount of accountsToUpdate) {\n        const encryptedValue = encryptValue(updatedAccount.value, userId);\n        const encryptedInterestRate = encryptValue(updatedAccount.interest_rate, userId);\n        const encryptedMonthlyContribution = encryptValue(updatedAccount.montly_contribution, userId);\n        \n        await supabase\n          .from(\"accounts\")\n          .update({\n            value: encryptedValue,\n            interest_rate: encryptedInterestRate,\n            montly_contribution: encryptedMonthlyContribution,\n            account_type: updatedAccount.account_type,\n            type: updatedAccount.type,\n            last_synced: updatedAccount.last_synced,\n            is_simplefin_synced: true,\n          })\n          .eq(\"id\", updatedAccount.id);\n      }\n\n      // Sync transactions after accounts are synced\n      const allAccounts = [...decryptedAccounts, ...newlyCreatedAccounts];\n      await syncTransactionsFromSettings(allAccounts);\n\n      setLastSyncTime(new Date());\n      \n    } catch (error) {\n      console.error(\"SimpleFin sync error:\", error);\n      alert(\"Failed to sync accounts. Please try again.\");\n    } finally {\n      setSyncing(false);\n    }\n  };\n\n  const syncTransactionsFromSettings = async (currentAccounts) => {\n    try {\n      // Fetch ALL existing purchases (including deleted ones) for duplicate detection\n      // Deleted purchases prevent re-syncing transactions that were manually removed\n      const { data: purchasesData } = await supabase\n        .from(\"purchases\")\n        .select(\"simplefin_transaction_id, simplefin_account_id, is_deleted\")\n        .eq(\"user_id\", userId);\n\n      // Sync transactions\n      const { transactionsToCreate } = await syncTransactions(\n        simpleFinAccessUrl,\n        currentAccounts,\n        purchasesData || []\n      );\n\n      if (transactionsToCreate.length === 0) {\n        console.log(\"No new transactions to sync\");\n        return;\n      }\n\n      console.log(`Syncing ${transactionsToCreate.length} new transactions`);\n\n      // Create new purchases from transactions\n      for (const transaction of transactionsToCreate) {\n        await supabase.from(\"purchases\").insert([{\n          ...transaction,\n          user_id: userId,\n        }]);\n      }\n\n      console.log(`Successfully synced ${transactionsToCreate.length} transactions`);\n      \n    } catch (error) {\n      console.error(\"Transaction sync error:\", error);\n      // Don't show error to user as this is secondary to account sync\n    }\n  };\n\n  const handleDisconnectSimpleFin = async () => {\n    try {\n      await supabase\n        .from(\"profiles\")\n        .update({ simplefin_access_url: null })\n        .eq(\"id\", userId);\n\n      setSimpleFinAccessUrl(null);\n      setLastSyncTime(null);\n      setShowDisconnectConfirm(false);\n    } catch (error) {\n      console.error(\"Error disconnecting SimpleFin:\", error);\n      alert(\"Failed to disconnect SimpleFin.\");\n    }\n  };\n\n  const handleSignOut = async () => {\n    try {\n      const { error } = await supabase.auth.signOut();\n      if (error) throw error;\n      // The page will likely need to refresh or redirect after sign out\n      window.location.href = \"/\";\n    } catch (error) {\n      console.error(\"Error signing out:\", error);\n    }\n  };\n\n\n\n  return (\n    <div className=\"w-full mx-auto p-6 bg-white dark:bg-slate-800 shadow-lg rounded-lg\">\n      <h1 className=\"text-3xl font-bold text-center text-gray-800 dark:text-white mb-6\">\n        Settings\n      </h1>\n      <div className=\"space-y-4\">\n        {mounted && (\n          <div className=\"flex items-center justify-between p-2 hover:bg-gray-50 dark:hover:bg-slate-700 rounded-md\">\n            <div>\n              <h3 className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                Dark Mode\n              </h3>\n              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                Toggle dark/light theme\n              </p>\n            </div>\n            <button\n              onClick={() => setTheme(theme === \"dark\" ? \"light\" : \"dark\")}\n              className=\"p-2 rounded-lg bg-gray-200 dark:bg-slate-600 hover:bg-gray-300 dark:hover:bg-slate-500 transition-colors\"\n              aria-label=\"Toggle theme\"\n            >\n              {theme === \"dark\" ? (\n                <Sun className=\"w-5 h-5 text-gray-700 dark:text-gray-200\" />\n              ) : (\n                <Moon className=\"w-5 h-5 text-gray-700 dark:text-gray-200\" />\n              )}\n            </button>\n          </div>\n        )}\n\n        {/* SimpleFin Controls */}\n        {simpleFinAccessUrl && (\n          <div className=\"border-t border-gray-200 dark:border-gray-600 pt-4 pb-4 space-y-3\">\n            <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-2\">\n              SimpleFin Sync\n            </h3>\n            <button\n              onClick={handleSimpleFinSync}\n              disabled={syncing}\n              className=\"w-full flex items-center justify-center gap-2 p-3 text-sm font-medium text-white bg-green-600 dark:bg-green-700 hover:bg-green-700 dark:hover:bg-green-800 rounded-md transition-colors disabled:opacity-50\"\n            >\n              <RefreshCw className={`w-4 h-4 ${syncing ? 'animate-spin' : ''}`} />\n              {syncing ? 'Syncing...' : 'Sync Accounts Now'}\n            </button>\n            {lastSyncTime && (\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 text-center\">\n                Last synced: {lastSyncTime.toLocaleTimeString()}\n              </p>\n            )}\n            <button\n              onClick={() => setShowDisconnectConfirm(true)}\n              className=\"w-full flex items-center justify-center gap-2 p-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-md transition-colors\"\n            >\n              <XIcon className=\"w-4 h-4\" />\n              Disconnect SimpleFin\n            </button>\n          </div>\n        )}\n\n        <div className=\"border-t border-gray-200 dark:border-gray-600 pt-4\">\n          <button\n            onClick={handleSignOut}\n            className=\"w-full flex items-center justify-center gap-2 p-2 text-sm font-medium text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition-colors\"\n          >\n            <LogOut className=\"w-4 h-4\" />\n            Sign Out\n          </button>\n        </div>\n      </div>\n      \n      {/* Disconnect Confirmation Modal */}\n      {showDisconnectConfirm && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white dark:bg-slate-800 rounded-lg shadow-2xl max-w-md w-full p-6\">\n            <h3 className=\"text-xl font-bold text-gray-800 dark:text-white mb-4\">\n              Disconnect SimpleFin?\n            </h3>\n            <p className=\"text-gray-600 dark:text-gray-300 mb-6\">\n              Your synced accounts will remain, but they will no longer automatically update. You can reconnect SimpleFin anytime from the Accounts page.\n            </p>\n            <div className=\"flex gap-3\">\n              <button\n                onClick={() => setShowDisconnectConfirm(false)}\n                className=\"flex-1 px-4 py-2.5 bg-gray-200 dark:bg-slate-700 text-gray-700 dark:text-gray-200 rounded-lg font-medium hover:bg-gray-300 dark:hover:bg-slate-600 transition-colors\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleDisconnectSimpleFin}\n                className=\"flex-1 px-4 py-2.5 bg-red-500 dark:bg-red-600 hover:bg-red-600 dark:hover:bg-red-700 text-white rounded-lg font-medium transition-colors\"\n              >\n                Disconnect\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default SettingsMobile;\n","/**\n * SimpleFin API Service\n * Handles all interactions with the SimpleFin API\n */\n\n/**\n * Claims an access URL from a SimpleFin setup token\n * @param {string} setupToken - Base64-encoded setup token from SimpleFin Bridge\n * @returns {Promise<string>} - The access URL for future API calls\n */\nexport async function claimAccessUrl(setupToken) {\n  try {\n    // Decode the Base64 setup token to get the claim URL\n    const claimUrl = atob(setupToken.trim());\n    \n    if (!claimUrl.startsWith('http')) {\n      throw new Error('Invalid setup token format');\n    }\n\n    // Use Supabase Edge Function\n    const supabaseUrl = process.env.REACT_APP_SUPABASE_URL;\n    const supabaseKey = process.env.REACT_APP_SUPABASE_ANON_KEY;\n    \n    const response = await fetch(`${supabaseUrl}/functions/v1/simplefin-proxy`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${supabaseKey}`,\n      },\n      body: JSON.stringify({ url: claimUrl, method: 'POST' }),\n    });\n    \n    const responseText = await response.text();\n\n    if (!response.ok) {\n      if (response.status === 429) {\n        throw new Error('RATE_LIMIT: Too many requests. Please wait a moment and try again.');\n      }\n      throw new Error(`Edge Function error (${response.status}): ${responseText}`);\n    }\n\n    const data = responseText;\n    \n    // The response should be the access URL\n    if (!data || !data.startsWith('http')) {\n      throw new Error('Invalid response from SimpleFin');\n    }\n\n    return data.trim();\n  } catch (error) {\n    if (error.message === 'RATE_LIMIT') {\n      throw error;\n    }\n    if (error.name === 'InvalidCharacterError') {\n      throw new Error('Invalid setup token. Please check and try again.');\n    }\n    throw new Error(`Failed to claim access URL: ${error.message}`);\n  }\n}\n\n/**\n * Fetches account data from SimpleFin API\n * @param {string} accessUrl - The access URL obtained from claiming\n * @param {Object} options - Optional parameters for the request\n * @param {number} options.startDate - Unix timestamp for transaction start date\n * @param {number} options.endDate - Unix timestamp for transaction end date\n * @returns {Promise<Object>} - Account data from SimpleFin\n */\nexport async function fetchAccounts(accessUrl, options = {}) {\n  try {\n    if (!accessUrl || !accessUrl.startsWith('http')) {\n      throw new Error('Invalid access URL');\n    }\n\n    // Append /accounts to the access URL\n    let accountsUrl = `${accessUrl}/accounts`;\n    \n    // Add date range parameters if provided\n    const params = [];\n    if (options.startDate) {\n      params.push(`start-date=${options.startDate}`);\n    }\n    if (options.endDate) {\n      params.push(`end-date=${options.endDate}`);\n    }\n    if (params.length > 0) {\n      accountsUrl += `?${params.join('&')}`;\n    }\n    \n    // Use Supabase Edge Function\n    const supabaseUrl = process.env.REACT_APP_SUPABASE_URL;\n    const supabaseKey = process.env.REACT_APP_SUPABASE_ANON_KEY;\n    \n    const response = await fetch(`${supabaseUrl}/functions/v1/simplefin-proxy`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${supabaseKey}`,\n      },\n      body: JSON.stringify({ url: accountsUrl, method: 'GET' }),\n    });\n\n    if (!response.ok) {\n      if (response.status === 429) {\n        // Extract retry-after header if available\n        const retryAfter = response.headers.get('Retry-After');\n        throw new Error(`RATE_LIMIT:${retryAfter || '60'}`);\n      }\n      if (response.status === 401 || response.status === 403) {\n        throw new Error('UNAUTHORIZED: Access URL is invalid or expired. Please reconnect SimpleFin.');\n      }\n      throw new Error(`Failed to fetch accounts: ${response.statusText}`);\n    }\n\n    const data = await response.json();\n    return data;\n  } catch (error) {\n    if (error.message.startsWith('RATE_LIMIT') || error.message.startsWith('UNAUTHORIZED')) {\n      throw error;\n    }\n    throw new Error(`Failed to fetch accounts: ${error.message}`);\n  }\n}\n\n/**\n * Maps a SimpleFin account object to our app's account format\n * @param {Object} sfAccount - SimpleFin account object\n * @returns {Object} - Mapped account object for our app\n */\nexport function mapSimpleFinAccount(sfAccount) {\n  // Extract balance first\n  let balance = 0;\n  if (sfAccount.balance !== undefined && sfAccount.balance !== null) {\n    balance = parseFloat(sfAccount.balance);\n  }\n  \n  // Check for available balance if balance is missing/zero\n  if (balance === 0 && sfAccount.available_balance !== undefined && sfAccount.available_balance !== null) {\n    balance = parseFloat(sfAccount.available_balance);\n  }\n  \n  // Determine account type based on SimpleFin data\n  let accountType = 'other';\n  const accountName = sfAccount.name?.toLowerCase() || '';\n  \n  // Map based on account name patterns\n  if (accountName.includes('checking') || accountName.includes('debit')) {\n    accountType = 'checking';\n  } else if (accountName.includes('savings')) {\n    accountType = 'savings';\n  } else if (accountName.includes('credit') || balance < 0) {\n    accountType = 'credit';\n  } else if (accountName.includes('loan') || accountName.includes('mortgage')) {\n    accountType = 'loan';\n  } else if (accountName.includes('investment') || accountName.includes('brokerage') || \n             accountName.includes('401k') || accountName.includes('ira')) {\n    accountType = 'investment';\n  }\n\n  // For credit cards and loans, balance should be positive (represents debt)\n  // SimpleFin returns credit card balances as negative\n  if (accountType === 'credit' || accountType === 'loan') {\n    balance = Math.abs(balance);\n  }\n\n  return {\n    simplefin_id: sfAccount.id,\n    name: sfAccount.name || 'Unnamed Account',\n    account_type: accountType,\n    value: balance,\n    is_simplefin_synced: true,\n    last_synced: new Date().toISOString(),\n    interest_rate: 0,\n    montly_contribution: 0,\n  };\n}\n\n/**\n * Retry wrapper for API calls with exponential backoff\n * @param {Function} apiCall - The API call function to retry\n * @param {number} maxRetries - Maximum number of retry attempts\n * @returns {Promise<any>} - Result of the API call\n */\nexport async function retryWithBackoff(apiCall, maxRetries = 3) {\n  let lastError;\n  \n  for (let attempt = 0; attempt < maxRetries; attempt++) {\n    try {\n      return await apiCall();\n    } catch (error) {\n      lastError = error;\n      \n      // Don't retry on these errors\n      if (error.message.startsWith('UNAUTHORIZED') || \n          error.message.includes('Invalid setup token') ||\n          error.message.includes('Invalid access URL')) {\n        throw error;\n      }\n      \n      // Handle rate limiting\n      if (error.message.startsWith('RATE_LIMIT')) {\n        const parts = error.message.split(':');\n        const retryAfter = parts.length > 1 ? parseInt(parts[1]) : 60;\n        \n        if (attempt < maxRetries - 1) {\n          // Wait for the retry-after period\n          await new Promise(resolve => setTimeout(resolve, retryAfter * 1000));\n          continue;\n        }\n        throw error;\n      }\n      \n      // Exponential backoff for other errors\n      if (attempt < maxRetries - 1) {\n        const delay = Math.pow(2, attempt) * 1000; // 1s, 2s, 4s\n        await new Promise(resolve => setTimeout(resolve, delay));\n      }\n    }\n  }\n  \n  throw lastError;\n}\n\n/**\n * Maps a SimpleFin transaction to our app's purchase format\n * @param {Object} sfTransaction - SimpleFin transaction object\n * @param {string} accountId - Local account ID\n * @param {string} simpleFinAccountId - SimpleFin account ID\n * @returns {Object} - Mapped purchase object for our app\n */\nexport function mapSimpleFinTransaction(sfTransaction, accountId, simpleFinAccountId) {\n  // SimpleFin transactions have negative amounts for purchases/debits\n  // We store purchases as positive amounts\n  const amount = Math.abs(parseFloat(sfTransaction.amount) || 0);\n  \n  // Skip transactions with zero amount or positive amounts (deposits/credits)\n  // We only want to import purchases (negative amounts in SimpleFin)\n  if (sfTransaction.amount >= 0 || amount === 0) {\n    return null;\n  }\n  \n  // Parse transaction date (SimpleFin uses Unix timestamp in seconds)\n  let transactionDate = new Date();\n  if (sfTransaction.posted) {\n    transactionDate = new Date(sfTransaction.posted * 1000);\n  } else if (sfTransaction.transacted_at) {\n    transactionDate = new Date(sfTransaction.transacted_at * 1000);\n  }\n  \n  return {\n    simplefin_transaction_id: sfTransaction.id,\n    simplefin_account_id: simpleFinAccountId,\n    item_name: sfTransaction.description || sfTransaction.payee || 'Unknown Transaction',\n    cost: amount,\n    timestamp: transactionDate.toISOString(),\n    is_simplefin_synced: true,\n    budget_item_id: null, // User will categorize manually\n  };\n}\n\n/**\n * Syncs SimpleFin accounts with local database\n * @param {string} accessUrl - SimpleFin access URL\n * @param {Array} existingAccounts - Current accounts from database\n * @returns {Promise<Object>} - Object with accounts to create and update\n */\nexport async function syncAccounts(accessUrl, existingAccounts = []) {\n  try {\n    // Fetch accounts from SimpleFin with retry logic\n    const data = await retryWithBackoff(() => fetchAccounts(accessUrl));\n    \n    if (!data || !data.accounts || !Array.isArray(data.accounts)) {\n      throw new Error('Invalid response format from SimpleFin');\n    }\n\n    const accountsToCreate = [];\n    const accountsToUpdate = [];\n\n    // Process each SimpleFin account\n    for (const sfAccount of data.accounts) {\n      const mappedAccount = mapSimpleFinAccount(sfAccount);\n      \n      // Check if account already exists\n      const existingAccount = existingAccounts.find(\n        acc => acc.simplefin_id === mappedAccount.simplefin_id\n      );\n\n      if (existingAccount) {\n        // Update existing account\n        accountsToUpdate.push({\n          id: existingAccount.id,\n          ...mappedAccount,\n          interest_rate: existingAccount.interest_rate,\n          montly_contribution: existingAccount.montly_contribution,\n          name: existingAccount.name || mappedAccount.name,\n        });\n      } else {\n        // New account to create\n        accountsToCreate.push(mappedAccount);\n      }\n    }\n\n    return {\n      accountsToCreate,\n      accountsToUpdate,\n      totalSynced: data.accounts.length,\n      rawData: data, // Include raw data for transaction processing\n    };\n  } catch (error) {\n    throw error;\n  }\n}\n\n/**\n * Syncs SimpleFin transactions with local purchases table\n * @param {string} accessUrl - SimpleFin access URL\n * @param {Array} localAccounts - Current accounts from database (with local IDs)\n * @param {Array} existingPurchases - Current purchases from database\n * @returns {Promise<Object>} - Object with transactions to create\n */\nexport async function syncTransactions(accessUrl, localAccounts = [], existingPurchases = []) {\n  try {\n    // Request transactions from the last 90 days\n    const endDate = Math.floor(Date.now() / 1000); // Current time in Unix timestamp\n    const startDate = endDate - (90 * 24 * 60 * 60); // 90 days ago\n    \n    // Fetch accounts from SimpleFin with retry logic (includes transactions)\n    const data = await retryWithBackoff(() => fetchAccounts(accessUrl, { startDate, endDate }));\n    \n    if (!data || !data.accounts || !Array.isArray(data.accounts)) {\n      throw new Error('Invalid response format from SimpleFin');\n    }\n\n    const transactionsToCreate = [];\n    \n    // Get set of existing SimpleFin transaction IDs for duplicate detection\n    // Include both active and deleted purchases to prevent re-importing deleted transactions\n    const existingTransactionIds = new Set(\n      existingPurchases\n        .filter(p => p.simplefin_transaction_id)\n        .map(p => p.simplefin_transaction_id)\n    );\n\n    // Process each SimpleFin account\n    for (const sfAccount of data.accounts) {\n      // Find the corresponding local account\n      const localAccount = localAccounts.find(\n        acc => acc.simplefin_id === sfAccount.id\n      );\n      \n      if (!localAccount) {\n        continue;\n      }\n\n      // Process transactions if they exist\n      if (sfAccount.transactions && Array.isArray(sfAccount.transactions)) {\n        for (const sfTransaction of sfAccount.transactions) {\n          // Skip if we've already imported this transaction\n          if (existingTransactionIds.has(sfTransaction.id)) {\n            continue;\n          }\n          \n          // Map transaction to purchase format\n          const mappedTransaction = mapSimpleFinTransaction(\n            sfTransaction,\n            localAccount.id,\n            sfAccount.id\n          );\n          \n          // Only add if it's a valid purchase (not a deposit/credit)\n          if (mappedTransaction) {\n            transactionsToCreate.push(mappedTransaction);\n          }\n        }\n      }\n    }\n\n    return {\n      transactionsToCreate,\n      totalSynced: transactionsToCreate.length,\n    };\n  } catch (error) {\n    throw error;\n  }\n}\n\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4', key: '1uf3rs' }],\n  ['polyline', { points: '16 17 21 12 16 7', key: '1gabdz' }],\n  ['line', { x1: '21', x2: '9', y1: '12', y2: '12', key: '1uyos4' }],\n];\n\n/**\n * @component @name LogOut\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNOSAyMUg1YTIgMiAwIDAgMS0yLTJWNWEyIDIgMCAwIDEgMi0yaDQiIC8+CiAgPHBvbHlsaW5lIHBvaW50cz0iMTYgMTcgMjEgMTIgMTYgNyIgLz4KICA8bGluZSB4MT0iMjEiIHgyPSI5IiB5MT0iMTIiIHkyPSIxMiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/log-out\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst LogOut = createLucideIcon('LogOut', __iconNode);\n\nexport default LogOut;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z', key: 'a7tn18' }],\n];\n\n/**\n * @component @name Moon\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTIgM2E2IDYgMCAwIDAgOSA5IDkgOSAwIDEgMS05LTlaIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/moon\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Moon = createLucideIcon('Moon', __iconNode);\n\nexport default Moon;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8', key: 'v9h5vc' }],\n  ['path', { d: 'M21 3v5h-5', key: '1q7to0' }],\n  ['path', { d: 'M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16', key: '3uifl3' }],\n  ['path', { d: 'M8 16H3v5', key: '1cv678' }],\n];\n\n/**\n * @component @name RefreshCw\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMyAxMmE5IDkgMCAwIDEgOS05IDkuNzUgOS43NSAwIDAgMSA2Ljc0IDIuNzRMMjEgOCIgLz4KICA8cGF0aCBkPSJNMjEgM3Y1aC01IiAvPgogIDxwYXRoIGQ9Ik0yMSAxMmE5IDkgMCAwIDEtOSA5IDkuNzUgOS43NSAwIDAgMS02Ljc0LTIuNzRMMyAxNiIgLz4KICA8cGF0aCBkPSJNOCAxNkgzdjUiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/refresh-cw\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst RefreshCw = createLucideIcon('RefreshCw', __iconNode);\n\nexport default RefreshCw;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['circle', { cx: '12', cy: '12', r: '4', key: '4exip2' }],\n  ['path', { d: 'M12 2v2', key: 'tus03m' }],\n  ['path', { d: 'M12 20v2', key: '1lh1kg' }],\n  ['path', { d: 'm4.93 4.93 1.41 1.41', key: '149t6j' }],\n  ['path', { d: 'm17.66 17.66 1.41 1.41', key: 'ptbguv' }],\n  ['path', { d: 'M2 12h2', key: '1t8f8n' }],\n  ['path', { d: 'M20 12h2', key: '1q8mjw' }],\n  ['path', { d: 'm6.34 17.66-1.41 1.41', key: '1m8zz5' }],\n  ['path', { d: 'm19.07 4.93-1.41 1.41', key: '1shlcs' }],\n];\n\n/**\n * @component @name Sun\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSI0IiAvPgogIDxwYXRoIGQ9Ik0xMiAydjIiIC8+CiAgPHBhdGggZD0iTTEyIDIwdjIiIC8+CiAgPHBhdGggZD0ibTQuOTMgNC45MyAxLjQxIDEuNDEiIC8+CiAgPHBhdGggZD0ibTE3LjY2IDE3LjY2IDEuNDEgMS40MSIgLz4KICA8cGF0aCBkPSJNMiAxMmgyIiAvPgogIDxwYXRoIGQ9Ik0yMCAxMmgyIiAvPgogIDxwYXRoIGQ9Im02LjM0IDE3LjY2LTEuNDEgMS40MSIgLz4KICA8cGF0aCBkPSJtMTkuMDcgNC45My0xLjQxIDEuNDEiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/sun\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Sun = createLucideIcon('Sun', __iconNode);\n\nexport default Sun;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M18 6 6 18', key: '1bl5f8' }],\n  ['path', { d: 'm6 6 12 12', key: 'd8bk6v' }],\n];\n\n/**\n * @component @name X\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTggNiA2IDE4IiAvPgogIDxwYXRoIGQ9Im02IDYgMTIgMTIiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/x\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst X = createLucideIcon('X', __iconNode);\n\nexport default X;\n"],"names":["SettingsMobile","userId","setUserId","useState","theme","setTheme","useTheme","mounted","setMounted","simpleFinAccessUrl","setSimpleFinAccessUrl","syncing","setSyncing","lastSyncTime","setLastSyncTime","showDisconnectConfirm","setShowDisconnectConfirm","useEffect","async","data","user","supabase","auth","getUser","id","profileData","from","select","eq","single","simplefin_access_url","decryptedUrl","decryptString","startsWith","error","console","getCurrentUser","syncTransactionsFromSettings","purchasesData","transactionsToCreate","syncTransactions","currentAccounts","length","log","concat","transaction","insert","_objectSpread","user_id","_jsxs","className","children","_jsx","onClick","Sun","Moon","accountsData","decryptedAccounts","map","account","value","decryptValue","interest_rate","montly_contribution","accountsToCreate","accountsToUpdate","syncAccounts","toCreate","toUpdate","newAccounts","newlyCreatedAccounts","newAccount","encryptedValue","encryptValue","encryptedInterestRate","encryptedMonthlyContribution","push","updatedAccount","update","account_type","type","last_synced","is_simplefin_synced","allAccounts","Date","alert","disabled","RefreshCw","toLocaleTimeString","XIcon","signOut","window","location","href","LogOut","claimAccessUrl","setupToken","claimUrl","atob","trim","Error","supabaseUrl","process","supabaseKey","response","fetch","method","headers","body","JSON","stringify","url","responseText","text","ok","status","message","name","fetchAccounts","accessUrl","options","arguments","undefined","accountsUrl","params","startDate","endDate","join","retryAfter","get","statusText","json","mapSimpleFinAccount","sfAccount","_sfAccount$name","balance","parseFloat","available_balance","accountType","accountName","toLowerCase","includes","Math","abs","simplefin_id","toISOString","retryWithBackoff","apiCall","lastError","maxRetries","attempt","parts","split","parseInt","Promise","resolve","setTimeout","delay","pow","mapSimpleFinTransaction","sfTransaction","accountId","simpleFinAccountId","amount","transactionDate","posted","transacted_at","simplefin_transaction_id","simplefin_account_id","item_name","description","payee","cost","timestamp","budget_item_id","existingAccounts","accounts","Array","isArray","mappedAccount","existingAccount","find","acc","totalSynced","rawData","localAccounts","existingPurchases","floor","now","existingTransactionIds","Set","filter","p","localAccount","transactions","has","mappedTransaction","createLucideIcon","d","key","points","x1","x2","y1","y2","cx","cy","r","X"],"sourceRoot":""}