/*! For license information please see 61.4dbdf0b6.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkpersonal_finance_tracker=self.webpackChunkpersonal_finance_tracker||[]).push([[61],{6061:(e,r,t)=>{t.r(r),t.d(r,{default:()=>y});var a=t(9379),d=t(5043),s=t(6058),o=t(9042),l=t(6361),n=t(3709),i=t(2031),c=t(885),b=t(1114);const m=(0,b.A)("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);var g=t(5349);const u=(0,b.A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),h=(0,b.A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),x=(0,b.A)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var f=t(863);const p=(0,b.A)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var k=t(579);l.t1.register(l.PP,l.kc,l.E8,l.hE,l.m_,l.s$,o.A);const y=function(){var e,r,t,l,b,y;const{userId:v}=(0,i.E)(),[w,j]=(0,d.useState)(!1),[N,D]=(0,d.useState)({labels:[],datasets:[]}),[S,C]=(0,d.useState)([]),[M,A]=(0,d.useState)(new Set),[F,I]=(0,d.useState)(!1),[z,_]=(0,d.useState)({fromDate:new Date((new Date).getFullYear(),(new Date).getMonth(),1).toISOString().split("T")[0],toDate:new Date((new Date).getFullYear(),(new Date).getMonth()+1,0).toISOString().split("T")[0]}),T=(0,d.useCallback)((async()=>{if(!v)return;I(!0);const{data:e,error:r}=await n.A.from("budget_items").select("\n        id, \n        name,\n        budget,\n        hidden,\n        purchases (cost)\n        ").eq("user_id",v).gte("purchases.timestamp",z.fromDate).lte("purchases.timestamp",z.toDate);if(r)return console.error("Budget fetch error:",r),void I(!1);const t=e.map((e=>(0,a.A)((0,a.A)({},e),{},{budget:(0,c.pN)(e.budget,v)})));C(t);const d=new Set(t.filter((e=>e.hidden)).map((e=>e.id)));A(d);const s=t.filter((e=>!e.hidden)),o=s.map((e=>e.budget)),l=s.map((e=>e.purchases.reduce(((e,r)=>e+r.cost),0))),i={labels:s.map((e=>e.name)),datasets:[{label:"Budgeted",data:o,backgroundColor:"rgba(59, 130, 246, 0.6)",borderColor:"rgb(37, 99, 235)",borderWidth:1,borderRadius:6,hoverBackgroundColor:"rgba(59, 130, 246, 0.8)"},{label:"Spent",data:l,backgroundColor:"rgba(239, 68, 68, 0.6)",borderColor:"rgb(220, 38, 38)",borderWidth:1,borderRadius:6,hoverBackgroundColor:"rgba(239, 68, 68, 0.8)"}]};return D(i),I(!1),i}),[v,z]);(0,d.useEffect)((()=>{if(v){T();const e=n.A.channel("budget_items_".concat(v)).on("postgres_changes",{event:"*",schema:"public",table:"budget_items",match:{user_id:v}},T).subscribe(),r=n.A.channel("purchases_".concat(v)).on("postgres_changes",{event:"*",schema:"public",table:"purchases",match:{user_id:v}},T).subscribe();return()=>{n.A.removeChannel(e),n.A.removeChannel(r)}}}),[v,z,T]);const B=async e=>{const{name:r,value:t}=e.target;_((e=>(0,a.A)((0,a.A)({},e),{},{[r]:t})))},O={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",align:"center",labels:{usePointStyle:!0,pointStyle:"circle",boxWidth:8,boxHeight:8,padding:10,font:{family:"'Inter', sans-serif",size:13,weight:"600"},color:"#4b5563"}},tooltip:{backgroundColor:"rgba(30, 41, 59, 0.95)",titleColor:"#f3f4f6",bodyColor:"#e5e7eb",borderColor:"rgba(148, 163, 184, 0.2)",borderWidth:1,cornerRadius:8,titleFont:{family:"'Inter', sans-serif",size:14,weight:"600"},bodyFont:{family:"'Inter', sans-serif",size:13},padding:12,displayColors:!0,boxWidth:8,boxHeight:8,usePointStyle:!0,callbacks:{title:function(e){return e[0].label},label:function(e){let r=e.dataset.label||"";return r&&(r+=": $"),null!==e.parsed.y&&(r+=new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e.parsed.y)),r}}},datalabels:{anchor:"end",align:"bottom",formatter:e=>e<10?"":"".concat(Math.round(e)),font:{family:"'Inter', sans-serif",weight:"600",size:window.innerWidth<768?8:12},color:e=>{const r=["rgb(0, 0, 0)","rgb(0, 0, 0)"];return r[e.datasetIndex%r.length]},offset:0,textShadow:"0 1px 2px rgba(0, 0, 0, 0.2)"}},scales:{x:{grid:{display:!0,color:"rgba(0, 0, 0, 0.03)",drawBorder:!1},ticks:{padding:10,font:{family:"'Inter', sans-serif",size:12,weight:"500"},color:"#6b7280"},border:{color:"rgba(0, 0, 0, 0.05)"}},y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.04)",drawBorder:!1},border:{display:!1},ticks:{padding:10,stepSize:Math.ceil(Math.max(...N.datasets.flatMap((e=>e.data)))/5),font:{family:"'Inter', sans-serif",size:12},color:"#6b7280",callback:function(e){return"$"+new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}}}},animation:{duration:1200,easing:"easeOutQuart"},elements:{bar:{borderRadius:4,borderWidth:0,borderSkipped:!1}},barPercentage:.9,categoryPercentage:.8},Y=(null===(e=N.datasets)||void 0===e||null===(r=e[0])||void 0===r||null===(t=r.data)||void 0===t?void 0:t.reduce(((e,r)=>e+r),0))||0,R=(null===(l=N.datasets)||void 0===l||null===(b=l[1])||void 0===b||null===(y=b.data)||void 0===y?void 0:y.reduce(((e,r)=>e+r),0))||0,P=Y?R/Y*100:0;return(0,k.jsxs)("div",{className:"w-full mx-auto p-6 bg-white dark:bg-slate-800 shadow-xl rounded-xl border border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 shadow-lg",children:(0,k.jsx)(m,{className:"text-white",size:24})}),(0,k.jsx)("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white",children:"Budget vs Spent"})]}),(0,k.jsxs)("button",{onClick:()=>{T()},className:"flex items-center gap-2 bg-blue-500 dark:bg-blue-600 hover:bg-blue-600 dark:hover:bg-blue-700 text-white px-4 py-2.5 rounded-lg transition-all shadow-md hover:shadow-lg font-medium",title:"Refresh data",children:[(0,k.jsx)(g.A,{size:18,className:F?"animate-spin":""}),(0,k.jsx)("span",{className:"hidden sm:inline",children:"Refresh"})]})]}),(0,k.jsxs)("div",{className:"bg-white dark:bg-slate-700 rounded-xl p-6 mb-8 shadow-xl border border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3 mb-5",children:[(0,k.jsx)("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400 shadow-sm",children:(0,k.jsx)(u,{size:20})}),(0,k.jsx)("h2",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Date Range"})]}),(0,k.jsxs)("div",{className:"space-y-5",children:[(0,k.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{htmlFor:"fromDate",className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"From Date"}),(0,k.jsx)("input",{type:"date",id:"fromDate",name:"fromDate",value:z.fromDate,onChange:B,className:"w-full rounded-lg border-2 border-gray-300 dark:border-gray-600 px-4 py-2.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors bg-white dark:bg-slate-600 text-gray-800 dark:text-white shadow-sm"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{htmlFor:"toDate",className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"To Date"}),(0,k.jsx)("input",{type:"date",id:"toDate",name:"toDate",value:z.toDate,onChange:B,className:"w-full rounded-lg border-2 border-gray-300 dark:border-gray-600 px-4 py-2.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors bg-white dark:bg-slate-600 text-gray-800 dark:text-white shadow-sm"})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,k.jsxs)("button",{onClick:()=>{const e=new Date;_({fromDate:new Date(e.getFullYear(),e.getMonth(),1).toISOString().split("T")[0],toDate:new Date(e.getFullYear(),e.getMonth()+1,0).toISOString().split("T")[0]})},className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 text-blue-700 dark:text-blue-300 px-4 py-3 rounded-lg hover:from-blue-500 hover:to-blue-600 hover:text-white dark:hover:from-blue-600 dark:hover:to-blue-700 transition-all font-semibold shadow-sm hover:shadow-md border border-blue-200 dark:border-blue-700",children:[(0,k.jsx)("span",{className:"hidden sm:inline",children:"Current Month"}),(0,k.jsx)("span",{className:"sm:hidden",children:"This Month"})]}),(0,k.jsxs)("button",{onClick:()=>{const e=new Date;_({fromDate:new Date(e.getFullYear(),e.getMonth()-1,1).toISOString().split("T")[0],toDate:new Date(e.getFullYear(),e.getMonth(),0).toISOString().split("T")[0]})},className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 text-blue-700 dark:text-blue-300 px-4 py-3 rounded-lg hover:from-blue-500 hover:to-blue-600 hover:text-white dark:hover:from-blue-600 dark:hover:to-blue-700 transition-all font-semibold shadow-sm hover:shadow-md border border-blue-200 dark:border-blue-700",children:[(0,k.jsx)("span",{className:"hidden sm:inline",children:"Previous Month"}),(0,k.jsx)("span",{className:"sm:hidden",children:"Last Month"})]}),(0,k.jsxs)("button",{onClick:()=>{const e=new Date;_({fromDate:new Date(e.getFullYear(),0,1).toISOString().split("T")[0],toDate:new Date(e.getFullYear(),11,31).toISOString().split("T")[0]})},className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 text-blue-700 dark:text-blue-300 px-4 py-3 rounded-lg hover:from-blue-500 hover:to-blue-600 hover:text-white dark:hover:from-blue-600 dark:hover:to-blue-700 transition-all font-semibold shadow-sm hover:shadow-md border border-blue-200 dark:border-blue-700",children:[(0,k.jsx)("span",{className:"hidden sm:inline",children:"Current Year"}),(0,k.jsx)("span",{className:"sm:hidden",children:"This Year"})]})]})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[(0,k.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 p-6 rounded-xl border-2 border-blue-200 dark:border-blue-700 shadow-sm",children:[(0,k.jsx)("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300 mb-2",children:"Total Budgeted"}),(0,k.jsxs)("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:["$",new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Y)]})]}),(0,k.jsxs)("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 p-6 rounded-xl border-2 border-orange-200 dark:border-orange-700 shadow-sm",children:[(0,k.jsx)("div",{className:"text-sm font-medium text-orange-700 dark:text-orange-300 mb-2",children:"Total Spent"}),(0,k.jsxs)("div",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400",children:["$",new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(R)]})]}),(0,k.jsxs)("div",{className:"bg-gradient-to-br ".concat(P>100?"from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 border-red-200 dark:border-red-700":"from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 border-green-200 dark:border-green-700"," p-6 rounded-xl border-2 shadow-sm"),children:[(0,k.jsx)("div",{className:"text-sm font-medium mb-2 ".concat(P>100?"text-red-700 dark:text-red-300":"text-green-700 dark:text-green-300"),children:"Budget Usage"}),(0,k.jsxs)("div",{className:"text-3xl font-bold ".concat(P>100?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"),children:[P.toFixed(1),"%"]}),(0,k.jsx)("div",{className:"mt-2",children:(0,k.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 overflow-hidden",children:(0,k.jsx)("div",{className:"h-2.5 rounded-full transition-all duration-500 ".concat(P>100?"bg-red-600 dark:bg-red-500":"bg-green-600 dark:bg-green-500"),style:{width:"".concat(Math.min(P,100),"%")}})})})]})]}),(0,k.jsxs)("div",{className:"w-full bg-white dark:bg-slate-700 rounded-xl shadow-xl p-6 mb-8 border border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3 mb-5",children:[(0,k.jsx)("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-lg bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-400 shadow-sm",children:(0,k.jsx)(m,{size:20})}),(0,k.jsx)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Budget vs. Spending Comparison"})]}),(0,k.jsx)("div",{className:"h-80 md:h-96 w-full",children:F?(0,k.jsxs)("div",{className:"h-full w-full flex flex-col items-center justify-center gap-4",children:[(0,k.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-200 border-t-blue-600 dark:border-blue-800 dark:border-t-blue-400"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"Loading chart data..."})]}):0===N.labels.length?(0,k.jsxs)("div",{className:"h-full w-full flex flex-col items-center justify-center gap-4",children:[(0,k.jsx)(m,{className:"w-16 h-16 text-gray-300 dark:text-gray-600"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No budget data to display"}),(0,k.jsx)("p",{className:"text-gray-400 dark:text-gray-500 text-sm",children:"Add budget items to see the comparison"})]}):(0,k.jsx)(s.yP,{data:N,options:O,plugins:[o.A]})})]}),(0,k.jsxs)("div",{className:"bg-white dark:bg-slate-700 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[(0,k.jsxs)("button",{className:"w-full flex items-center justify-between p-6 cursor-pointer hover:bg-gray-50 dark:hover:bg-slate-600 transition-colors",onClick:()=>j(!w),children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-lg bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-400 shadow-sm",children:(0,k.jsx)(h,{size:20})}),(0,k.jsx)("h2",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Category Visibility"}),(0,k.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:["(",S.filter((e=>!e.hidden)).length," of ",S.length," visible)"]})]}),(0,k.jsx)("div",{className:"p-2 rounded-lg bg-gray-100 dark:bg-slate-600",children:w?(0,k.jsx)(x,{size:20,className:"text-gray-600 dark:text-gray-300"}):(0,k.jsx)(f.A,{size:20,className:"text-gray-600 dark:text-gray-300"})})]}),w&&(0,k.jsx)("div",{className:"px-6 pb-6 border-t border-gray-200 dark:border-gray-600 pt-5",children:S.length>0?(0,k.jsx)("div",{className:"flex flex-wrap gap-3",children:S.map((e=>(0,k.jsxs)("button",{onClick:()=>(async e=>{const r=S.find((r=>r.id===e));if(!r)return;const{error:t}=await n.A.from("budget_items").update({hidden:!r.hidden}).eq("id",e).eq("user_id",v);t&&console.error("Error updating visibility:",t)})(e.id),className:"px-4 py-2.5 rounded-xl flex items-center gap-2 text-sm font-semibold transition-all shadow-sm hover:shadow-md ".concat(e.hidden?"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 border-2 border-gray-300 dark:border-gray-600":"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 text-blue-700 dark:text-blue-300 hover:from-blue-100 hover:to-blue-200 dark:hover:from-blue-800/40 dark:hover:to-blue-700/40 border-2 border-blue-300 dark:border-blue-600"),children:[e.hidden?(0,k.jsx)(p,{size:16,className:"text-gray-500 dark:text-gray-400"}):(0,k.jsx)(h,{size:16,className:"text-blue-600 dark:text-blue-400"}),(0,k.jsx)("span",{children:e.name})]},e.id)))}):(0,k.jsxs)("div",{className:"text-center py-8 bg-gray-50 dark:bg-slate-600 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-500",children:[(0,k.jsx)(m,{className:"w-12 h-12 mx-auto text-gray-400 dark:text-gray-500 mb-3"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"No budget items found"}),(0,k.jsx)("p",{className:"text-gray-400 dark:text-gray-500 text-sm mt-1",children:"Create budget items to track spending"})]})})]})]})}},863:(e,r,t)=>{t.d(r,{A:()=>a});const a=(0,t(1114).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},5349:(e,r,t)=>{t.d(r,{A:()=>a});const a=(0,t(1114).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}}]);
//# sourceMappingURL=61.4dbdf0b6.chunk.js.map