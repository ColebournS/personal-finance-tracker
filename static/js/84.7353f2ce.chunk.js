/*! For license information please see 84.7353f2ce.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkpersonal_finance_tracker=self.webpackChunkpersonal_finance_tracker||[]).push([[84],{9084:(e,t,r)=>{r.r(t),r.d(t,{default:()=>N});var a=r(5043),s=r(3709),l=r(5177),d=r(1114);const n=(0,d.A)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),i=(0,d.A)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var o=r(1184),c=r(4183),u=r(4401),x=r(7897);const m=(0,d.A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var g=r(6953),p=r(7669);const h=(0,d.A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),b=(0,d.A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var y=r(2031),k=r(9379);const v=(0,d.A)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),f=(0,d.A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var j=r(579);const w=e=>{let{isOpen:t,onClose:r}=e;const{budgetGroups:l,userId:d,refetchPurchases:n}=(0,y.E)(),[i,o]=(0,a.useState)({itemName:"",cost:"",budgetItemId:""});if(!t)return null;const c=e=>{const{name:t,value:r}=e.target;o((e=>(0,k.A)((0,k.A)({},e),{},{[t]:r})))};return(0,j.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50 backdrop-blur-sm",onClick:r,children:(0,j.jsxs)("div",{className:"w-full max-w-2xl mx-auto p-8 bg-white dark:bg-slate-800 shadow-2xl rounded-xl border border-gray-200 dark:border-gray-700 relative max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,j.jsx)("button",{onClick:r,className:"absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-700 rounded-lg transition-all z-10",children:(0,j.jsx)(p.A,{size:24})}),(0,j.jsxs)("div",{className:"text-center mb-4",children:[(0,j.jsx)("div",{className:"inline-flex items-center justify-center p-3 bg-blue-100 dark:bg-blue-900/30 rounded-full mb-4",children:(0,j.jsx)(v,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),(0,j.jsx)("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white",children:"Add Purchase"})]}),(0,j.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=(new Date).toISOString().split("T")[0],t={item_name:i.itemName.trim(),user_id:d,cost:parseFloat(i.cost)||0,budget_item_id:i.budgetItemId,timestamp:new Date(e+"T00:00:00Z").toISOString()},{error:a}=await s.A.from("purchases").insert([t]);if(a)throw a;await n(),o({itemName:"",cost:"",budgetItemId:""}),r()}catch(t){console.error("Error saving purchase:",t),alert("Failed to save purchase. Please try again.")}},className:"space-y-6",children:[(0,j.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,j.jsxs)("div",{className:"md:col-span-2",children:[(0,j.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:["Item Name ",(0,j.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",children:(0,j.jsx)(x.A,{size:20})}),(0,j.jsx)("input",{type:"text",name:"itemName",value:i.itemName,onChange:c,required:!0,placeholder:"e.g., Groceries, Coffee, Gas",className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-800 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 focus:outline-none transition-all"})]})]}),(0,j.jsxs)("div",{children:[(0,j.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:["Cost ",(0,j.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,j.jsxs)("div",{className:"relative",children:[(0,j.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500",children:(0,j.jsx)(u.A,{size:20})}),(0,j.jsx)("input",{type:"number",name:"cost",value:i.cost,onChange:c,required:!0,min:"0",step:"0.01",placeholder:"0.00",className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-800 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 focus:outline-none transition-all"})]})]}),(0,j.jsxs)("div",{children:[(0,j.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:["Budget Category ",(0,j.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,j.jsxs)("select",{name:"budgetItemId",value:i.budgetItemId,onChange:c,required:!0,className:"w-full px-4 py-3 bg-gray-50 dark:bg-slate-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-800 dark:text-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 focus:outline-none transition-all cursor-pointer appearance-none bg-no-repeat bg-right pr-10",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'%3E%3Cpath fill='%236B7280' d='M4.427 6.573l3.396 3.396a.25.25 0 00.354 0l3.396-3.396A.25.25 0 0011.396 6H4.604a.25.25 0 00-.177.427z'/%3E%3C/svg%3E\")",backgroundPosition:"right 0.75rem center",backgroundSize:"1.25rem"},children:[(0,j.jsx)("option",{value:"",children:"Select a category"}),l.map((e=>{var t;return(0,j.jsx)("optgroup",{label:e.name,className:"font-semibold",children:null===(t=e.budget_items)||void 0===t?void 0:t.map((e=>(0,j.jsx)("option",{value:e.id,className:"font-normal",children:e.name},e.id)))},e.id)}))]})]})]}),(0,j.jsxs)("button",{type:"submit",className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 dark:from-blue-600 dark:to-blue-700 text-white py-3.5 px-6 rounded-lg hover:from-blue-600 hover:to-blue-700 dark:hover:from-blue-700 dark:hover:to-blue-800 transition-all shadow-lg hover:shadow-xl transform hover:scale-[1.02] active:scale-[0.98] flex items-center justify-center font-semibold text-lg",children:[(0,j.jsx)(f,{className:"mr-2",size:22}),"Add Purchase"]})]})]})})},N=()=>{const{purchases:e,budgetGroups:t,refetchPurchases:r,userId:d}=(0,y.E)(),[k,v]=(0,a.useState)(!1),[f,N]=(0,a.useState)(null),[C,A]=(0,a.useState)(null),[_,z]=(0,a.useState)(""),[S,I]=(0,a.useState)(0),[D,M]=(0,a.useState)(""),[F,E]=(0,a.useState)(""),[P,B]=(0,a.useState)({key:"timestamp",direction:"desc"}),[T,q]=(0,a.useState)(!1),[L,O]=(0,a.useState)([]),[H,U]=(0,a.useState)(!1),[R,K]=(0,a.useState)("budget"),V=(0,a.useRef)(!1),$=(0,a.useRef)({searchTerm:"",filterBudgetItem:"",showDeleted:!1}),G=async()=>{if(d)try{const{data:e,error:t}=await s.A.from("purchases").select("\n          id,\n          item_name,\n          cost,\n          timestamp,\n          budget_item_id,\n          simplefin_transaction_id,\n          is_simplefin_synced,\n          is_deleted,\n          budget_items (\n            id,\n            name,\n            budget,\n            budget_groups (\n              id,\n              name\n            )\n          )\n        ").eq("user_id",d).eq("is_deleted",!0).order("timestamp",{ascending:!1});if(t)throw t;O(e||[])}catch(e){console.error("Error fetching deleted purchases:",e)}},Y=async e=>{try{const{error:t}=await s.A.from("purchases").update({is_deleted:!0}).eq("id",e);if(t)throw t;await r(),T&&await G()}catch(t){console.error("Error deleting purchase:",t),alert("Failed to delete purchase. Please try again.")}},Z=async e=>{try{const{error:t}=await s.A.from("purchases").update({is_deleted:!1}).eq("id",e);if(t)throw t;await r(),await G()}catch(t){console.error("Error restoring purchase:",t),alert("Failed to restore purchase. Please try again.")}},X=(e,t)=>{switch(A(e),N(t.id),e){case"timestamp":z(new Date(t.timestamp).toISOString().split("T")[0]);break;case"itemName":z(t.item_name);break;case"cost":z(t.cost);break;case"budgetItemId":z(t.budget_item_id||"");break;default:z("")}},J=async(e,t)=>{try{const a={};switch(e){case"timestamp":a.timestamp=new Date(t+"T00:00:00Z").toISOString();break;case"itemName":a.item_name=t.trim();break;case"cost":a.cost=parseFloat(t)||0;break;case"budgetItemId":a.budget_item_id=t||null}const{error:l}=await s.A.from("purchases").update(a).eq("id",f);if(l)throw l;N(null),A(null),z(""),await r()}catch(a){console.error("Error updating ".concat(e,":"),a),alert("Failed to update ".concat(e,". Please try again."))}},{availableMonths:Q,currentPurchases:W,currentMonthName:ee,currentMonthTotal:te,purchasesByCategory:re}=(0,a.useMemo)((()=>{let t=T?[...L]:[...e];D&&(t=t.filter((e=>{var t,r,a;return(null===(t=e.item_name)||void 0===t?void 0:t.toLowerCase().includes(D.toLowerCase()))||(null===(r=e.budget_items)||void 0===r||null===(a=r.name)||void 0===a?void 0:a.toLowerCase().includes(D.toLowerCase()))}))),"uncategorized"===F?t=t.filter((e=>!e.budget_item_id)):F&&(t=t.filter((e=>e.budget_item_id===F))),t.sort(((e,t)=>{var r,a,s,l,d,n;let i,o;switch(P.key){case"timestamp":i=new Date(e.timestamp),o=new Date(t.timestamp);break;case"item_name":i=(null===(r=e.item_name)||void 0===r?void 0:r.toLowerCase())||"",o=(null===(a=t.item_name)||void 0===a?void 0:a.toLowerCase())||"";break;case"cost":i=e.cost,o=t.cost;break;case"budget_item":i=(null===(s=e.budget_items)||void 0===s||null===(l=s.name)||void 0===l?void 0:l.toLowerCase())||"",o=(null===(d=t.budget_items)||void 0===d||null===(n=d.name)||void 0===n?void 0:n.toLowerCase())||"";break;default:return 0}return i<o?"asc"===P.direction?-1:1:i>o?"asc"===P.direction?1:-1:0}));const r={};t.forEach((e=>{const t=new Date(e.timestamp),a="".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"));r[a]||(r[a]=[]),r[a].push(e)}));const a=new Date,s="".concat(a.getFullYear(),"-").concat(String(a.getMonth()+1).padStart(2,"0"));r[s]||(r[s]=[]);const l=Object.keys(r).sort(((e,t)=>t.localeCompare(e))),d=l[S],n=d?r[d]:[];let i="",o=0;if(d){const[e,t]=d.split("-").map(Number);i=new Date(e,t-1,1).toLocaleDateString("en-US",{month:"short",year:"numeric"})}n.length>0&&(o=n.reduce(((e,t)=>e+t.cost),0));let c={};if("budget"===R&&n.length>0){n.forEach((e=>{const t=e.budget_item_id||"uncategorized";var r,a;c[t]||(c[t]={name:(null===(r=e.budget_items)||void 0===r?void 0:r.name)||"Uncategorized",budget:(null===(a=e.budget_items)||void 0===a?void 0:a.budget)||0,purchases:[]});c[t].purchases.push(e)}));const e={};Object.keys(c).sort(((e,t)=>"uncategorized"===e?1:"uncategorized"===t?-1:c[e].name.localeCompare(c[t].name))).forEach((t=>{e[t]=c[t]})),c=e}return{availableMonths:l,currentPurchases:n,currentMonthName:i,currentMonthTotal:o,purchasesByCategory:c}}),[e,L,T,D,F,P,R,S]);(0,a.useEffect)((()=>{($.current.searchTerm!==D||$.current.filterBudgetItem!==F||$.current.showDeleted!==T)&&($.current={searchTerm:D,filterBudgetItem:F,showDeleted:T},V.current=!1)}),[D,F,T]),(0,a.useEffect)((()=>{if(0===Q.length)return;const e=new Date,t="".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0")),r=Q.indexOf(t);-1===r||V.current?-1===r&&!1===V.current&&(V.current=!0):(I(r),V.current=!0)}),[Q,e.length]);const ae=Q.length,se=()=>{try{window.scrollTo({top:0,behavior:"smooth"})}catch(e){"undefined"!==typeof window&&window.scrollTo(0,0)}},le=e=>{B((t=>({key:e,direction:t.key===e&&"asc"===t.direction?"desc":"asc"})))},de=e=>P.key!==e?(0,j.jsx)(l.A,{size:14,className:"opacity-40"}):"asc"===P.direction?(0,j.jsx)(l.A,{size:14,className:"text-blue-600 dark:text-blue-400"}):(0,j.jsx)(l.A,{size:14,className:"text-blue-600 dark:text-blue-400 rotate-180"}),ne=e=>{var r;return(0,j.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors group",children:[(0,j.jsx)("td",{onClick:()=>X("timestamp",e),className:"px-6 py-4 whitespace-nowrap cursor-pointer",children:"timestamp"===C&&f===e.id?(0,j.jsx)("input",{type:"date",value:_,onChange:e=>z(e.target.value),onBlur:()=>{J("timestamp",_),A(null),N(null)},onKeyDown:e=>{"Enter"===e.key&&e.target.blur()},className:"w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-slate-600 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 transition-all",autoFocus:!0}):(0,j.jsxs)("div",{className:"flex items-center gap-2 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:[(0,j.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:new Date(e.timestamp).toLocaleDateString(void 0,{month:"short",day:"numeric"})}),(0,j.jsx)(n,{size:14,className:"opacity-0 group-hover:opacity-50 transition-opacity"})]})}),(0,j.jsx)("td",{onClick:()=>X("itemName",e),className:"px-6 py-4 cursor-pointer",children:"itemName"===C&&f===e.id?(0,j.jsx)("input",{type:"text",value:_,onChange:e=>z(e.target.value),onBlur:()=>{J("itemName",_),A(null),N(null)},onKeyDown:e=>{"Enter"===e.key&&e.target.blur()},className:"w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-slate-600 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 transition-all",autoFocus:!0}):(0,j.jsxs)("div",{className:"flex items-center gap-2 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:[(0,j.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.item_name}),(0,j.jsx)(n,{size:14,className:"opacity-0 group-hover:opacity-50 transition-opacity"})]})}),(0,j.jsx)("td",{onClick:()=>X("cost",e),className:"px-6 py-4 whitespace-nowrap cursor-pointer",children:"cost"===C&&f===e.id?(0,j.jsx)("input",{type:"number",value:_,onChange:e=>z(e.target.value),onBlur:()=>{J("cost",_),A(null),N(null)},onKeyDown:e=>{"Enter"===e.key&&e.target.blur()},className:"w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-slate-600 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 transition-all",min:"0",step:"0.01",autoFocus:!0}):(0,j.jsxs)("div",{className:"flex items-center gap-2 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:[(0,j.jsxs)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:["$",e.cost.toFixed(2)]}),(0,j.jsx)(n,{size:14,className:"opacity-0 group-hover:opacity-50 transition-opacity"})]})}),(0,j.jsx)("td",{onClick:()=>X("budgetItemId",e),className:"px-6 py-4 cursor-pointer",children:"budgetItemId"===C&&f===e.id?(0,j.jsxs)("select",{value:_||"",onChange:e=>{const t=e.target.value;z(t),J("budgetItemId",t)},onBlur:()=>{A(null),N(null)},className:"w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-slate-600 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 transition-all",autoFocus:!0,children:[(0,j.jsx)("option",{value:"",children:"Uncategorized"}),t.map((e=>{var t;return(0,j.jsx)("optgroup",{label:e.name,children:null===(t=e.budget_items)||void 0===t?void 0:t.map((e=>(0,j.jsx)("option",{value:e.id,children:e.name},e.id)))},e.id)}))]}):(0,j.jsxs)("div",{className:"flex items-center gap-2 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:[(0,j.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-purple-100 dark:bg-purple-900/50 text-purple-800 dark:text-purple-200",children:(null===(r=e.budget_items)||void 0===r?void 0:r.name)||"Uncategorized"}),(0,j.jsx)(n,{size:14,className:"opacity-0 group-hover:opacity-50 transition-opacity"})]})}),(0,j.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:T?(0,j.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to restore this purchase?")&&Z(e.id)},className:"inline-flex items-center justify-center p-2 text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-lg transition-all",title:"Restore purchase",children:(0,j.jsx)(i,{size:18})}):(0,j.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to delete this purchase?")&&Y(e.id)},className:"inline-flex items-center justify-center p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all",title:"Delete purchase",children:(0,j.jsx)(o.A,{size:18})})})]},e.id)},ie=e=>{var r;return(0,j.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-md hover:shadow-lg border border-gray-200 dark:border-slate-700 p-1.5 transition-all duration-200 hover:scale-[1.01]",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between mb-3 pb-2.5 border-b border-gray-100 dark:border-slate-700 gap-2",children:[(0,j.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,j.jsx)("div",{className:"cursor-pointer flex-shrink-0",children:"timestamp"===C&&f===e.id?(0,j.jsx)("input",{type:"date",value:_,onChange:e=>z(e.target.value),onBlur:()=>{J("timestamp",_),A(null),N(null)},onKeyDown:e=>{"Enter"===e.key&&e.target.blur()},className:"px-3 py-2 border dark:border-gray-600 rounded-md bg-white dark:bg-slate-600 text-gray-800 dark:text-white text-base focus:ring-2 focus:ring-blue-500",autoFocus:!0}):(0,j.jsxs)("div",{onClick:t=>{t.stopPropagation(),X("timestamp",e)},onTouchEnd:t=>{t.preventDefault(),t.stopPropagation(),X("timestamp",e)},className:"flex items-center gap-1 px-2 py-1 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800 active:scale-95 transition-all whitespace-nowrap cursor-pointer",children:[(0,j.jsx)(c.A,{size:12,className:"text-blue-600 dark:text-blue-400 flex-shrink-0"}),(0,j.jsx)("span",{className:"text-xs font-bold text-blue-700 dark:text-blue-200",children:new Date(e.timestamp).toLocaleDateString(void 0,{month:"short",day:"numeric"})})]})}),(0,j.jsxs)("div",{className:"flex items-center gap-2 ml-auto",children:[(0,j.jsx)("div",{className:"cursor-pointer flex-shrink-0",children:"budgetItemId"===C&&f===e.id?(0,j.jsxs)("select",{value:_||"",onChange:e=>{const t=e.target.value;z(t),J("budgetItemId",t)},onBlur:()=>{A(null),N(null)},className:"px-2 py-1.5 border dark:border-gray-600 rounded-lg bg-white dark:bg-slate-600 text-gray-800 dark:text-white text-xs focus:ring-2 focus:ring-blue-500",autoFocus:!0,children:[(0,j.jsx)("option",{value:"",children:"Uncategorized"}),t.map((e=>{var t;return(0,j.jsx)("optgroup",{label:e.name,children:null===(t=e.budget_items)||void 0===t?void 0:t.map((e=>(0,j.jsx)("option",{value:e.id,children:e.name},e.id)))},e.id)}))]}):(0,j.jsx)("div",{onClick:t=>{t.stopPropagation(),X("budgetItemId",e)},onTouchEnd:t=>{t.preventDefault(),t.stopPropagation(),X("budgetItemId",e)},className:"inline-flex items-center px-2 py-1 rounded-lg text-xs font-semibold bg-gradient-to-r from-purple-100 to-indigo-100 dark:from-purple-900/40 dark:to-indigo-900/40 text-purple-700 dark:text-purple-200 border border-purple-200 dark:border-purple-800 shadow-sm active:scale-95 transition-all max-w-[80px] sm:max-w-[100px]",children:(0,j.jsx)("span",{className:"truncate",children:(null===(r=e.budget_items)||void 0===r?void 0:r.name)||"Uncategorized"})})}),!("budgetItemId"===C&&f===e.id)&&(0,j.jsx)("div",{className:"cursor-pointer group flex-shrink-0",children:"cost"===C&&f===e.id?(0,j.jsx)("input",{type:"number",inputMode:"decimal",value:_,onChange:e=>z(e.target.value),onBlur:()=>{J("cost",_),A(null),N(null)},onKeyDown:e=>{"Enter"===e.key&&e.target.blur()},className:"w-20 px-2 py-1.5 border dark:border-gray-600 rounded-lg bg-white dark:bg-slate-600 text-gray-800 dark:text-white text-sm focus:ring-2 focus:ring-blue-500",min:"0",step:"0.01",autoFocus:!0}):(0,j.jsxs)("div",{onClick:t=>{t.stopPropagation(),X("cost",e)},onTouchEnd:t=>{t.preventDefault(),t.stopPropagation(),X("cost",e)},className:"flex items-center gap-1 px-2 py-1 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-lg border border-green-200 dark:border-green-800 group-hover:shadow-sm transition-all active:scale-95 whitespace-nowrap",children:[(0,j.jsx)(u.A,{size:12,className:"text-green-600 dark:text-green-400 flex-shrink-0"}),(0,j.jsx)("span",{className:"text-xs font-bold text-green-700 dark:text-green-400",children:e.cost.toFixed(2)})]})})]})]}),T?(0,j.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to restore this purchase?")&&Z(e.id)},className:"p-2 text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-lg transition-all active:scale-95 flex-shrink-0",title:"Restore purchase",children:(0,j.jsx)(i,{size:16})}):(0,j.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to delete this purchase?")&&Y(e.id)},className:"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all active:scale-95 flex-shrink-0",title:"Delete purchase",children:(0,j.jsx)(o.A,{size:16})})]}),(0,j.jsx)("div",{className:"flex items-center gap-2",children:(0,j.jsx)("div",{className:"flex-1 min-w-0 cursor-pointer group",children:"itemName"===C&&f===e.id?(0,j.jsx)("input",{type:"text",value:_,onChange:e=>z(e.target.value),onBlur:()=>{J("itemName",_),A(null),N(null)},onKeyDown:e=>{"Enter"===e.key&&e.target.blur()},className:"w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-slate-600 text-gray-800 dark:text-white text-base focus:ring-2 focus:ring-blue-500",autoFocus:!0}):(0,j.jsxs)("div",{onClick:t=>{t.stopPropagation(),X("itemName",e)},onTouchEnd:t=>{t.preventDefault(),t.stopPropagation(),X("itemName",e)},className:"flex items-center gap-2 active:opacity-70 transition-opacity px-4",children:[(0,j.jsx)(x.A,{size:14,className:"text-gray-400 dark:text-gray-500 flex-shrink-0"}),(0,j.jsx)("h3",{className:"text-sm font-medium text-gray-900 dark:text-white leading-snug truncate group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:e.item_name})]})})})]},e.id)};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(w,{isOpen:k,onClose:()=>v(!1)}),(0,j.jsxs)("div",{className:"w-full shadow-xl rounded-xl overflow-hidden",children:[(0,j.jsxs)("div",{className:"px-3 bg-white dark:bg-slate-800 md:px-6 py-3 md:py-8 border-b border-gray-200 dark:border-gray-700",children:[(0,j.jsxs)("div",{className:"flex items-center justify-between mb-1 md:mb-2",children:[(0,j.jsx)("h1",{className:"text-sm md:text-3xl font-bold text-gray-800 dark:text-white",children:"Purchases"}),(0,j.jsxs)("div",{className:"flex items-center gap-2 md:gap-3",children:[(0,j.jsxs)("div",{className:"inline-flex items-center rounded-full bg-gray-100 dark:bg-slate-700 p-0.5 shadow-inner border border-gray-200 dark:border-slate-600 text-[10px] md:text-xs",children:[(0,j.jsxs)("button",{type:"button",onClick:()=>K("budget"),className:"px-2.5 md:px-3 py-1 md:py-1.5 rounded-full flex items-center gap-1 transition-all ".concat("budget"===R?"bg-white dark:bg-slate-800 text-purple-700 dark:text-purple-200 shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"),children:[(0,j.jsx)(x.A,{size:12,className:"budget"===R?"text-purple-500":"text-gray-400"}),(0,j.jsx)("span",{className:"hidden sm:inline",children:"By Category"}),(0,j.jsx)("span",{className:"sm:hidden",children:"Category"})]}),(0,j.jsxs)("button",{type:"button",onClick:()=>K("simple"),className:"px-2.5 md:px-3 py-1 md:py-1.5 rounded-full flex items-center gap-1 transition-all ".concat("simple"===R?"bg-white dark:bg-slate-800 text-blue-700 dark:text-blue-200 shadow-sm":"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"),children:[(0,j.jsx)(c.A,{size:12,className:"simple"===R?"text-blue-500":"text-gray-400"}),(0,j.jsx)("span",{className:"hidden sm:inline",children:"By Date"}),(0,j.jsx)("span",{className:"sm:hidden",children:"Date"})]})]}),(0,j.jsxs)("button",{onClick:()=>v(!0),className:"flex items-center gap-1 md:gap-2 px-3 py-1.5 md:px-4 md:py-2 bg-blue-500 dark:bg-blue-600 hover:bg-blue-600 dark:hover:bg-blue-700 text-white rounded-lg transition-all shadow-md hover:shadow-lg font-semibold text-xs md:text-base",children:[(0,j.jsx)(m,{size:16,className:"md:w-5 md:h-5"}),(0,j.jsx)("span",{className:"hidden sm:inline",children:"Add Purchase"})]})]})]}),ae>0&&ee&&(0,j.jsxs)("div",{className:"flex items-center gap-1.5 md:gap-2 text-gray-600 dark:text-gray-400",children:[(0,j.jsx)(c.A,{size:14,className:"md:w-[18px] md:h-[18px]"}),(0,j.jsx)("span",{className:"text-xs md:text-lg font-medium",children:ee})]})]}),(0,j.jsx)("div",{className:"p-3 md:p-6 border-b dark:border-slate-700 bg-gray-50 dark:bg-slate-900/50",children:H?(0,j.jsx)("div",{className:"flex gap-2",children:(0,j.jsxs)("div",{className:"flex-1 relative",children:[(0,j.jsx)(g.A,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-500",size:16}),(0,j.jsx)("input",{type:"text",placeholder:"Search purchases...",value:D,onChange:e=>{M(e.target.value),I(0)},onBlur:()=>{D||setTimeout((()=>U(!1)),100)},autoFocus:!0,className:"w-full h-8 pl-8 pr-8 border dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-xs"}),(0,j.jsx)("button",{onClick:()=>{M(""),U(!1)},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,j.jsx)(p.A,{size:14})})]})}):(0,j.jsxs)("div",{className:"flex gap-2 md:gap-4",children:[(0,j.jsx)("button",{onClick:()=>U(!0),className:"sm:hidden flex items-center justify-center w-8 h-8 bg-white dark:bg-slate-800 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700 transition-all flex-shrink-0",children:(0,j.jsx)(g.A,{size:16})}),(0,j.jsxs)("div",{className:"hidden sm:flex flex-1 relative",children:[(0,j.jsx)(g.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-500",size:16}),(0,j.jsx)("input",{type:"text",placeholder:"Search purchases...",value:D,onChange:e=>{M(e.target.value),I(0)},className:"w-full pl-10 pr-10 py-2.5 border dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-base"}),D&&(0,j.jsx)("button",{onClick:()=>M(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,j.jsx)(p.A,{size:18})})]}),(0,j.jsx)("div",{className:"w-32 sm:w-48 md:w-64",children:(0,j.jsxs)("select",{value:F,onChange:e=>{E(e.target.value),I(0)},className:"w-full h-8 md:h-auto px-2 md:px-4 md:py-2.5 border dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-xs md:text-base",children:[(0,j.jsx)("option",{value:"",children:"All"}),(0,j.jsx)("option",{value:"uncategorized",children:"Uncategorized"}),t.map((e=>{var t;return(0,j.jsx)("optgroup",{label:e.name,children:null===(t=e.budget_items)||void 0===t?void 0:t.map((e=>(0,j.jsx)("option",{value:e.id,children:e.name},e.id)))},e.id)}))]})}),(0,j.jsx)("button",{onClick:async()=>{const e=!T;q(e),e&&await G(),I(0)},className:"h-8 md:h-auto px-2.5 md:px-4 md:py-2.5 rounded-lg font-medium transition-all text-xs md:text-base flex-shrink-0 whitespace-nowrap ".concat(T?"bg-orange-500 dark:bg-orange-600 text-white shadow-md":"bg-white dark:bg-slate-700 text-gray-700 dark:text-gray-200 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-slate-600"),children:T?"Show Active":"Show Hidden"})]})}),0===W.length?(0,j.jsxs)("div",{className:"p-8 md:p-12 text-center",children:[(0,j.jsx)("div",{className:"inline-flex items-center justify-center w-12 h-12 md:w-16 md:h-16 rounded-full bg-gray-100 dark:bg-slate-700 mb-3 md:mb-4",children:(0,j.jsx)(g.A,{className:"text-gray-400",size:24})}),(0,j.jsx)("h3",{className:"text-base md:text-lg font-semibold text-gray-900 dark:text-white mb-2",children:ee?"No purchases in ".concat(ee):"No purchases found"}),(0,j.jsx)("p",{className:"text-sm md:text-base text-gray-500 dark:text-gray-400",children:D||F?"Try adjusting your filters":ee?"":"Start by adding your first purchase"})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"hidden md:block overflow-x-auto",children:(0,j.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-slate-700",children:[(0,j.jsx)("thead",{className:"bg-gray-50 dark:bg-slate-900",children:(0,j.jsxs)("tr",{children:[(0,j.jsx)("th",{onClick:()=>le("timestamp"),className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors group",children:(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(c.A,{size:16,className:"text-gray-400"}),"Date",de("timestamp")]})}),(0,j.jsx)("th",{onClick:()=>le("item_name"),className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors group",children:(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(x.A,{size:16,className:"text-gray-400"}),"Item Name",de("item_name")]})}),(0,j.jsx)("th",{onClick:()=>le("cost"),className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors group",children:(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsx)(u.A,{size:16,className:"text-gray-400"}),"Cost",de("cost")]})}),(0,j.jsx)("th",{onClick:()=>le("budget_item"),className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors group",children:(0,j.jsxs)("div",{className:"flex items-center gap-2",children:["Budget Item",de("budget_item")]})}),(0,j.jsx)("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider"})]})}),(0,j.jsx)("tbody",{className:"bg-white dark:bg-slate-800",children:"budget"===R&&Object.keys(re).length>0?Object.entries(re).map((e=>{let[t,r]=e;const s=r.purchases.reduce(((e,t)=>e+t.cost),0),l=r.budget-s;return(0,j.jsxs)(a.Fragment,{children:[(0,j.jsx)("tr",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900/20 dark:to-indigo-900/20 border-y-2 border-purple-200 dark:border-purple-700",children:(0,j.jsx)("td",{colSpan:"5",className:"px-6 py-4",children:(0,j.jsxs)("div",{className:"flex items-center justify-between",children:[(0,j.jsxs)("div",{className:"flex items-center gap-3",children:[(0,j.jsx)("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/40 rounded-lg",children:(0,j.jsx)(x.A,{className:"text-purple-600 dark:text-purple-400",size:18})}),(0,j.jsxs)("div",{children:[(0,j.jsx)("div",{className:"text-lg font-bold text-purple-900 dark:text-purple-100",children:r.name}),(0,j.jsxs)("div",{className:"hidden md:block text-sm text-purple-700 dark:text-purple-300",children:[r.purchases.length," ",1===r.purchases.length?"purchase":"purchases"]})]})]}),r.budget>0&&(0,j.jsxs)("div",{className:"flex items-center gap-6",children:[(0,j.jsxs)("div",{className:"text-right",children:[(0,j.jsx)("div",{className:"text-xs text-purple-600 dark:text-purple-400 font-medium",children:"Budgeted"}),(0,j.jsxs)("div",{className:"text-base font-bold text-purple-900 dark:text-purple-100",children:["$",r.budget.toFixed(2)]})]}),(0,j.jsxs)("div",{className:"text-right",children:[(0,j.jsx)("div",{className:"text-xs text-purple-600 dark:text-purple-400 font-medium",children:"Spent"}),(0,j.jsxs)("div",{className:"text-base font-bold ".concat(s>r.budget?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"),children:["$",s.toFixed(2)]})]}),(0,j.jsxs)("div",{className:"text-right",children:[(0,j.jsx)("div",{className:"text-xs text-purple-600 dark:text-purple-400 font-medium",children:"Remaining"}),(0,j.jsxs)("div",{className:"text-base font-bold ".concat(l<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"),children:["$",l.toFixed(2)]})]})]})]})})}),r.purchases.map((e=>ne(e)))]},t)})):W.map((e=>ne(e)))})]})}),(0,j.jsx)("div",{className:"md:hidden py-3 space-y-3",children:"budget"===R&&Object.keys(re).length>0?Object.entries(re).map((e=>{let[t,r]=e;return(0,j.jsxs)(a.Fragment,{children:[(0,j.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900/20 dark:to-indigo-900/20 rounded-lg p-1.5 border-2 border-purple-200 dark:border-purple-700 mb-2",children:(0,j.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,j.jsx)("div",{className:"p-1 bg-purple-100 dark:bg-purple-900/40 rounded-lg",children:(0,j.jsx)(x.A,{className:"text-purple-600 dark:text-purple-400",size:12})}),(0,j.jsx)("div",{className:"flex-1",children:(0,j.jsx)("div",{className:"text-xs font-bold text-purple-900 dark:text-purple-100",children:r.name})})]})}),r.purchases.map((e=>ie(e)))]},t)})):W.map((e=>ie(e)))})]}),ae>0&&(0,j.jsx)("div",{className:"px-3 md:px-6 py-3 md:py-4 bg-gray-50 dark:bg-slate-900/50 border-t dark:border-slate-700",children:(0,j.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 md:gap-4",children:[(0,j.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[(0,j.jsxs)("div",{className:"text-xs md:text-sm text-gray-600 dark:text-gray-400",children:[(0,j.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:W.length})," ",1===W.length?"purchase":"purchases"," ","in"," ",(0,j.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:ee})]}),W.length>0&&(0,j.jsxs)("div",{className:"text-xs md:text-sm font-semibold",children:[(0,j.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Total: "}),(0,j.jsxs)("span",{className:"text-green-600 dark:text-green-400",children:["$",te.toFixed(2)]})]})]}),(0,j.jsxs)("div",{className:"flex items-center gap-2",children:[(0,j.jsxs)("button",{onClick:()=>{S>0&&(I((e=>e-1)),se())},disabled:0===S,className:"inline-flex items-center gap-1 md:gap-2 px-3 md:px-4 py-1.5 md:py-2 text-xs md:text-sm font-medium rounded-lg transition-all ".concat(0===S?"text-gray-400 dark:text-gray-600 cursor-not-allowed bg-gray-100 dark:bg-slate-800":"text-gray-700 dark:text-gray-200 bg-white dark:bg-slate-700 hover:bg-gray-50 dark:hover:bg-slate-600 border border-gray-300 dark:border-slate-600"),children:[(0,j.jsx)(h,{size:16,className:"md:w-[18px] md:h-[18px]"}),(0,j.jsx)("span",{className:"hidden sm:inline",children:"Previous"})]}),(0,j.jsxs)("span",{className:"px-2 sm:px-3 md:px-4 py-1.5 md:py-2 text-xs md:text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-slate-700 rounded-lg border border-gray-300 dark:border-slate-600 whitespace-nowrap",children:["Month ",S+1," of ",ae]}),(0,j.jsxs)("button",{onClick:()=>{S<ae-1&&(I((e=>e+1)),se())},disabled:S===ae-1,className:"inline-flex items-center gap-1 md:gap-2 px-3 md:px-4 py-1.5 md:py-2 text-xs md:text-sm font-medium rounded-lg transition-all ".concat(S===ae-1?"text-gray-400 dark:text-gray-600 cursor-not-allowed bg-gray-100 dark:bg-slate-800":"text-gray-700 dark:text-gray-200 bg-white dark:bg-slate-700 hover:bg-gray-50 dark:hover:bg-slate-600 border border-gray-300 dark:border-slate-600"),children:[(0,j.jsx)("span",{className:"hidden sm:inline",children:"Next"}),(0,j.jsx)(b,{size:16,className:"md:w-[18px] md:h-[18px]"})]})]})]})})]})]})}},5177:(e,t,r)=>{r.d(t,{A:()=>a});const a=(0,r(1114).A)("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]])},4183:(e,t,r)=>{r.d(t,{A:()=>a});const a=(0,r(1114).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},4401:(e,t,r)=>{r.d(t,{A:()=>a});const a=(0,r(1114).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},6953:(e,t,r)=>{r.d(t,{A:()=>a});const a=(0,r(1114).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},7897:(e,t,r)=>{r.d(t,{A:()=>a});const a=(0,r(1114).A)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]])},1184:(e,t,r)=>{r.d(t,{A:()=>a});const a=(0,r(1114).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},7669:(e,t,r)=>{r.d(t,{A:()=>a});const a=(0,r(1114).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}}]);
//# sourceMappingURL=84.7353f2ce.chunk.js.map