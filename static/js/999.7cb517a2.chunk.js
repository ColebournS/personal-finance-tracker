/*! For license information please see 999.7cb517a2.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkpersonal_finance_tracker=self.webpackChunkpersonal_finance_tracker||[]).push([[999],{2999:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});var s=a(5043),l=a(3709),r=a(1184),n=a(1114);const c=(0,n.A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),i=(0,n.A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var d=a(2031),o=a(579);const u=()=>{const{purchases:e,budgetGroups:t,refetchPurchases:a}=(0,d.E)(),[n,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(null),[x,p]=(0,s.useState)(""),[b,g]=(0,s.useState)(1),w=(e,t)=>{switch(h(e),u(t.id),e){case"timestamp":p(new Date(t.timestamp).toISOString().split("T")[0]);break;case"itemName":p(t.item_name);break;case"cost":p(t.cost);break;case"budgetItemId":p(t.budget_item_id);break;default:p("")}},y=async(e,t)=>{try{const s={};switch(e){case"timestamp":s.timestamp=new Date(t+"T00:00:00Z").toISOString();break;case"itemName":s.item_name=t.trim();break;case"cost":s.cost=parseFloat(t)||0;break;case"budgetItemId":s.budget_item_id=t}const{error:r}=await l.A.from("purchases").update(s).eq("id",n);if(r)throw r;u(null),h(null),p(""),await a()}catch(s){console.error("Error updating ".concat(e,":"),s),alert("Failed to update ".concat(e,". Please try again."))}},j=Math.ceil(e.length/10),v=10*(b-1),f=v+10,N=e.slice(v,f);return(0,o.jsxs)("div",{className:"w-full max-w-screen overflow-x-auto p-6 bg-white shadow-lg rounded-lg",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-center text-gray-800 mb-6",children:"Purchases"}),(0,o.jsx)("div",{className:"w-full overflow-x-auto",children:(0,o.jsxs)("div",{className:"inline-block min-w-full align-middle",children:[(0,o.jsxs)("table",{className:"min-w-full table-auto border bg-blue-50 rounded-md",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{className:"bg-blue-100",children:[(0,o.jsx)("th",{className:"p-3 text-left text-gray-700",children:"Date"}),(0,o.jsx)("th",{className:"p-3 text-left text-gray-700",children:"Item Name"}),(0,o.jsx)("th",{className:"p-3 text-left text-gray-700",children:"Cost"}),(0,o.jsx)("th",{className:"p-3 text-left text-gray-700",children:"Budget Item"}),(0,o.jsx)("th",{className:"p-3 w-10"})]})}),(0,o.jsx)("tbody",{children:N.map((e=>{var s;return(0,o.jsxs)("tr",{className:"border-b hover:bg-blue-100",children:[(0,o.jsx)("td",{onClick:()=>w("timestamp",e),className:"p-2",children:"timestamp"===m&&n===e.id?(0,o.jsx)("input",{type:"date",value:x,onChange:e=>p(e.target.value),onBlur:()=>{y("timestamp",x),h(null),u(null)},className:"w-full px-2 py-1 border rounded",autoFocus:!0}):new Date(e.timestamp).toLocaleDateString(void 0,{month:"numeric",day:"numeric"})}),(0,o.jsx)("td",{onClick:()=>w("itemName",e),className:"p-2 truncate",style:{maxWidth:"6ch",overflow:"hidden",whiteSpace:"nowrap"},children:"itemName"===m&&n===e.id?(0,o.jsx)("input",{type:"text",value:x,onChange:e=>p(e.target.value),onBlur:()=>{y("itemName",x),h(null),u(null)},className:"w-full px-2 py-1 border rounded",autoFocus:!0}):e.item_name}),(0,o.jsx)("td",{onClick:()=>w("cost",e),className:"p-2",children:"cost"===m&&n===e.id?(0,o.jsx)("input",{type:"number",value:x,onChange:e=>p(e.target.value),onBlur:()=>{y("cost",x),h(null),u(null)},className:"w-full px-2 py-1 border rounded",min:"0",step:"0.01",autoFocus:!0}):"$".concat(e.cost.toFixed(2))}),(0,o.jsx)("td",{onClick:()=>w("budgetItemId",e),className:"p-2 text-overflow:ellipsis",children:"budgetItemId"===m&&n===e.id?(0,o.jsxs)("select",{value:x,onChange:e=>{const t=e.target.value;p(t),y("budgetItemId",t)},onBlur:()=>{h(null),u(null)},className:"w-full px-2 py-1 border rounded",autoFocus:!0,children:[(0,o.jsx)("option",{value:"",children:"Select a budget item"}),t.map((e=>{var t;return(0,o.jsx)("optgroup",{label:e.name,children:null===(t=e.budget_items)||void 0===t?void 0:t.map((e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id)))},e.id)}))]}):null===(s=e.budget_items)||void 0===s?void 0:s.name}),(0,o.jsx)("td",{className:"p-2 text-center",children:(0,o.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to delete this purchase?")&&(async e=>{try{const{error:t}=await l.A.from("purchases").delete().eq("id",e);if(t)throw t;await a()}catch(t){console.error("Error deleting purchase:",t),alert("Failed to delete purchase. Please try again.")}})(e.id)},className:"text-red-500 hover:text-red-700 transition-colors",children:(0,o.jsx)(r.A,{size:20})})})]},e.id)}))})]}),(0,o.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,o.jsxs)("div",{className:"text-sm text-gray-700",children:["Showing ",v+1," to ",Math.min(f,e.length)," ","of ",e.length," purchases"]}),(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)("button",{onClick:()=>{b>1&&g(b-1)},disabled:1===b,className:"p-2 rounded ".concat(1===b?"text-gray-400 cursor-not-allowed":"text-blue-600 hover:text-blue-800"),children:(0,o.jsx)(c,{size:20})}),(0,o.jsxs)("span",{className:"text-sm text-gray-700",children:["Page ",b," of ",j]}),(0,o.jsx)("button",{onClick:()=>{b<j&&g(b+1)},disabled:b===j,className:"p-2 rounded ".concat(b===j?"text-gray-400 cursor-not-allowed":"text-blue-600 hover:text-blue-800"),children:(0,o.jsx)(i,{size:20})})]})]})]})})]})}},1184:(e,t,a)=>{a.d(t,{A:()=>s});const s=(0,a(1114).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}}]);
//# sourceMappingURL=999.7cb517a2.chunk.js.map